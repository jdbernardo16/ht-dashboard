import{m as _,j as $,x as E,s as S,d as V,o as c,w as a,e as o,a as p,t as n,c as d,i as A,q as u}from"./app-DMsrlBw0.js";import{_ as N}from"./AuthenticatedLayout-CoyhxnNm.js";import{_ as j,a as T}from"./Pagination-CBc77TNp.js";import{_ as B}from"./SearchFilter-CfrCYFaO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-Dm6rggBr.js";const F={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},O={class:"flex items-center"},P={class:"flex-shrink-0 h-10 w-10"},q={class:"h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center"},D={class:"text-white font-medium text-sm"},I={class:"ml-4"},M={class:"font-medium text-gray-900"},U={key:0,class:"text-sm text-gray-500"},Y=["href"],z={key:1,class:"text-gray-400"},G={key:0},H={key:1,class:"text-gray-400"},J={class:"font-medium text-blue-600"},K={class:"font-medium text-green-600"},ee={__name:"Index",props:{clients:{type:Object,required:!0},filters:{type:Object,default:()=>({})}},setup(f){const i=f,r=_(!1),l=_({search:i.filters.search||""}),h=$(()=>i.clients.data||[]),v=[{key:"name",label:"Client",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"company",label:"Company",sortable:!0},{key:"sales_count",label:"Sales",type:"number",sortable:!0},{key:"content_posts_count",label:"Content Posts",type:"number",sortable:!0}],y=()=>{u.visit("/clients/create")},g=s=>{u.visit(`/clients/${s.id}/edit`)},x=s=>{u.visit(`/clients/${s.id}`)},b=async s=>{if(confirm("Are you sure you want to delete this client? This action cannot be undone."))try{r.value=!0,await u.delete(`/clients/${s.id}`,{preserveScroll:!0,onSuccess:()=>{},onError:t=>{console.error("Error deleting client:",t),t.message?.includes("403")&&alert("You don't have permission to delete this client.")},onFinish:()=>{r.value=!1}})}catch(t){r.value=!1,console.error("Error deleting client:",t)}},m=()=>{r.value=!0;const s={};Object.keys(l.value).forEach(t=>{l.value[t]&&(s[t]=l.value[t])}),u.get("/clients",s,{preserveState:!0,preserveScroll:!0,only:["clients","filters"],onError:t=>{console.error("Error applying filters:",t),t.message?.includes("403")&&alert("You don't have permission to view clients.")},onFinish:()=>{r.value=!1}})},k=()=>{l.value={search:""},m()},w=s=>{u.visit(s,{preserveState:!0,preserveScroll:!0,only:["clients","filters"]})},C=(s,t)=>`${s?.charAt(0)||""}${t?.charAt(0)||""}`.toUpperCase();return E(l,()=>{clearTimeout(window.filterTimeout),window.filterTimeout=setTimeout(()=>{m()},300)},{deep:!0}),S(()=>{}),(s,t)=>(c(),V(N,null,{header:a(()=>t[1]||(t[1]=[o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Client Management ",-1)])),default:a(()=>[o("div",null,[o("div",F,[p(B,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),filters:["search"],onApply:m,onClear:k},null,8,["modelValue"]),p(j,{data:h.value,columns:v,filters:[],loading:r.value,onCreate:y,onView:x,onEdit:g,onDelete:b},{name:a(({item:e})=>[o("div",O,[o("div",P,[o("div",q,[o("span",D,n(C(e.first_name,e.last_name)),1)])]),o("div",I,[o("div",M,n(e.first_name)+" "+n(e.last_name),1),e.company?(c(),d("div",U,n(e.company),1)):A("",!0)])])]),email:a(({item:e})=>[e.email?(c(),d("a",{key:0,href:`mailto:${e.email}`,class:"text-indigo-600 hover:text-indigo-900"},n(e.email),9,Y)):(c(),d("span",z,"N/A"))]),phone:a(({item:e})=>[e.phone?(c(),d("span",G,n(e.phone),1)):(c(),d("span",H,"N/A"))]),sales_count:a(({item:e})=>[o("span",J,n(e.sales_count||0),1)]),content_posts_count:a(({item:e})=>[o("span",K,n(e.content_posts_count||0),1)]),_:1},8,["data","loading"]),p(T,{links:i.clients.links,from:i.clients.from,to:i.clients.to,total:i.clients.total,onNavigate:w},null,8,["links","from","to","total"])])])]),_:1}))}};export{ee as default};
