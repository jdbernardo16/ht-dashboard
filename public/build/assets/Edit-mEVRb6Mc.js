import{b as X,x as H,m as _,j as W,d as Q,o as c,w as N,e as l,f as P,a as r,k as b,n as m,u as n,c as g,F as x,y as w,t as f,z as A,v as Z,p as V,i as h,g as ee,A as j,q}from"./app-DMsrlBw0.js";import{_ as te}from"./AuthenticatedLayout-CoyhxnNm.js";import{_ as d,b as u,a as y}from"./TextInput-FbyQ28m3.js";import{_ as z}from"./BaseFileUploader.vue_vue_type_script_setup_true_lang-BrDptZMF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},ne=["value"],re={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},ae=["id","value"],ie=["for"],de={class:"mt-1"},ue={class:"relative"},ce=["onClick"],me=["disabled"],ge=["disabled"],pe={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 p-2"},fe={class:"text-sm text-gray-600 flex items-center justify-between"},be={class:"font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded"},ve={key:0,class:"mt-1 p-2 bg-gray-50 border border-gray-200 rounded-md"},ye={class:"flex flex-wrap gap-1"},_e=["onClick","onKeydown"],xe={class:"text-xs text-gray-500 mt-1"},we={key:0,class:"mb-4"},he=["src"],ke={key:0,class:"mb-4"},Pe={class:"space-y-2"},Ve={class:"flex items-center space-x-2"},Ce={class:"text-sm text-gray-700"},Fe={class:"text-xs text-gray-500"},De=["href"],Se={class:"flex items-center justify-end space-x-3"},Te=["disabled"],Be={__name:"Edit",props:{contentPost:{type:Object,required:!0},clients:{type:Array,required:!0}},setup($){const I=s=>s?new Date(s).toISOString().split("T")[0]:"",G=s=>{if(s===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,i)).toFixed(2))+" "+t[i]},a=$,K=[{value:"website",label:"Website"},{value:"facebook",label:"Facebook"},{value:"instagram",label:"Instagram"},{value:"twitter",label:"Twitter"},{value:"linkedin",label:"LinkedIn"},{value:"tiktok",label:"TikTok"},{value:"youtube",label:"YouTube"},{value:"pinterest",label:"Pinterest"},{value:"email",label:"Email"},{value:"other",label:"Other"}],o=X({client_id:a.contentPost.client_id!==void 0?a.contentPost.client_id:null,title:a.contentPost.title||"",platform:Array.isArray(a.contentPost.platform)?a.contentPost.platform:[],content_type:a.contentPost.content_type||"",description:a.contentPost.description||"",content_url:a.contentPost.content_url||"",image:null,post_count:a.contentPost.post_count||1,scheduled_date:I(a.contentPost.scheduled_date),published_date:I(a.contentPost.published_date),status:a.contentPost.status||"draft",content_category:a.contentPost.content_category||"",tags:(()=>{if(Array.isArray(a.contentPost.tags))return a.contentPost.tags;if(typeof a.contentPost.tags=="string")try{const s=JSON.parse(a.contentPost.tags);return Array.isArray(s)?s:[]}catch{return a.contentPost.tags.split(",").map(e=>e.trim()).filter(e=>e)}return[]})(),notes:a.contentPost.notes||"",meta_description:a.contentPost.meta_description||"",seo_keywords:a.contentPost.seo_keywords||"",media:[]});H(()=>o.image,s=>{s&&typeof s=="object"&&s.file instanceof File&&(o.image=s.file,console.log("Extracted File object from FileData:",s.file.name))},{deep:!0});const v=_(""),C=_(null),F=_(!1),k=_(""),M=_(["social-media","blog","video","image","campaign","promotional","educational","entertainment"]),D=W(()=>Array.isArray(o.tags)?o.tags.filter(s=>s&&s.trim()):[]),O=()=>{C.value&&C.value.focus()},L=()=>{const s=v.value.trim();k.value=s},R=s=>{const e=v.value.trim();s.key==="Enter"||s.key===","||s.keyCode===188?(s.preventDefault(),e&&S(e)):s.key==="Backspace"&&!e&&D.value.length>0&&(s.preventDefault(),E(D.value.length-1))},B=s=>{s?.preventDefault?.(),s?.stopPropagation?.();const e=v.value.trim();e&&S(e)},S=s=>{if(!s)return;const e=s.trim();e&&(o.tags.includes(e)||o.tags.push(e),v.value="",k.value="")},E=s=>{s>=0&&s<o.tags.length&&o.tags.splice(s,1)},T=s=>{S(s)},J=()=>{const s={...o.data()};if(console.log("Original form data:",s),s.client_id===""||s.client_id===null?(s.client_id=null,console.log("Client ID set to null")):(s.client_id=parseInt(s.client_id),console.log("Client ID converted to number:",s.client_id)),s.published_date){const t=new Date(s.published_date);if(!isNaN(t.getTime())){const i=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),U=String(t.getDate()).padStart(2,"0");s.published_date=`${i}-${p}-${U}`,console.log("Published date formatted:",s.published_date)}}if(s.scheduled_date){const t=new Date(s.scheduled_date);if(!isNaN(t.getTime())){const i=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),U=String(t.getDate()).padStart(2,"0");s.scheduled_date=`${i}-${p}-${U}`,console.log("Scheduled date formatted:",s.scheduled_date)}}s.content_url===""&&(s.content_url=null,console.log("Content URL set to null"));const e=new FormData;Object.keys(s).forEach(t=>{t==="media"?Array.isArray(s.media)&&s.media.forEach((i,p)=>{i?.file instanceof File&&e.append(`media[${p}]`,i.file)}):t==="image"?(console.log("Processing image field:",s.image),s.image&&s.image.file instanceof File?(e.append(t,s.image.file),console.log("Appended image file:",s.image.file.name)):s.image instanceof File?(e.append(t,s.image),console.log("Appended direct File object:",s.image.name)):console.log("Image field is not a valid File object or FileData:",s.image)):Array.isArray(s[t])?t==="platform"||t==="tags"?e.append(t,JSON.stringify(s[t])):s[t].forEach((i,p)=>{e.append(`${t}[${p}]`,i)}):s[t]===null?e.append(t,""):e.append(t,s[t])}),console.log("FormData client_id:",e.get("client_id")),console.log("FormData published_date:",e.get("published_date")),console.log("FormData scheduled_date:",e.get("scheduled_date")),console.log("FormData content_url:",e.get("content_url")),console.log("FormData image field:",e.get("image")),console.log("Form image field value:",s.image),console.log("Form image field type:",typeof s.image),console.log("Final form data being submitted:");for(let t of e.entries())console.log(t[0]+":",t[1]);o.put(route("content.web.update",a.contentPost.id),{data:e},{preserveScroll:!0,onSuccess:()=>{console.log("Content post updated successfully"),q.visit(route("content.web.show",a.contentPost.id))},onError:t=>{console.error("Error updating content post:",t),t.client_id&&console.error("Client ID error:",t.client_id),t.content_type&&console.error("Content Type error:",t.content_type)}})},Y=()=>{q.visit(route("content.web.show",a.contentPost.id))};return(s,e)=>(c(),Q(te,null,{header:N(()=>e[20]||(e[20]=[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Edit Content Post ",-1)])),default:N(()=>[l("div",null,[l("div",oe,[l("div",se,[l("div",le,[l("form",{onSubmit:P(J,["prevent"]),class:"space-y-6"},[l("div",null,[r(d,{for:"client_id",value:"Client *"}),b(l("select",{id:"client_id","onUpdate:modelValue":e[0]||(e[0]=t=>n(o).client_id=t),required:"",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.client_id}])},[e[21]||(e[21]=l("option",{value:""},"Select a client",-1)),(c(!0),g(x,null,w($.clients,t=>(c(),g("option",{key:t.id,value:t.id},f(t.name),9,ne))),128))],2),[[A,n(o).client_id]]),r(u,{message:n(o).errors.client_id,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"title",value:"Title *"}),r(y,{id:"title",modelValue:n(o).title,"onUpdate:modelValue":e[1]||(e[1]=t=>n(o).title=t),type:"text",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.title}]),required:"",autofocus:""},null,8,["modelValue","class"]),r(u,{message:n(o).errors.title,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{value:"Platforms *",class:"mb-2"}),l("div",re,[(c(),g(x,null,w(K,t=>l("div",{key:t.value,class:"flex items-center"},[b(l("input",{type:"checkbox",id:`platform-${t.value}`,value:t.value,"onUpdate:modelValue":e[2]||(e[2]=i=>n(o).platform=i),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,8,ae),[[Z,n(o).platform]]),l("label",{for:`platform-${t.value}`,class:"ml-2 text-sm text-gray-700"},f(t.label),9,ie)])),64))]),r(u,{message:n(o).errors.platform,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"content_type",value:"Content Type *"}),b(l("select",{id:"content_type","onUpdate:modelValue":e[3]||(e[3]=t=>n(o).content_type=t),required:"",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.content_type}])},e[22]||(e[22]=[l("option",{value:""}," Select content type ",-1),l("option",{value:"post"},"Post",-1),l("option",{value:"story"},"Story",-1),l("option",{value:"reel"},"Reel",-1),l("option",{value:"video"},"Video",-1),l("option",{value:"image"},"Image",-1),l("option",{value:"carousel"},"Carousel",-1),l("option",{value:"live"},"Live",-1),l("option",{value:"article"},"Article",-1)]),2),[[A,n(o).content_type]]),r(u,{message:n(o).errors.content_type,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"description",value:"Description"}),b(l("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=t=>n(o).description=t),rows:"3",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.description}])},null,2),[[V,n(o).description]]),r(u,{message:n(o).errors.description,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"content_url",value:"Content URL"}),r(y,{id:"content_url",modelValue:n(o).content_url,"onUpdate:modelValue":e[5]||(e[5]=t=>n(o).content_url=t),type:"url",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.content_url}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.content_url,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"post_count",value:"Post Count"}),r(y,{id:"post_count",modelValue:n(o).post_count,"onUpdate:modelValue":e[6]||(e[6]=t=>n(o).post_count=t),type:"number",min:"1",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.post_count}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.post_count,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"scheduled_date",value:"Scheduled Date"}),r(y,{id:"scheduled_date",modelValue:n(o).scheduled_date,"onUpdate:modelValue":e[7]||(e[7]=t=>n(o).scheduled_date=t),type:"date",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.scheduled_date}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.scheduled_date,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"published_date",value:"Published Date"}),r(y,{id:"published_date",modelValue:n(o).published_date,"onUpdate:modelValue":e[8]||(e[8]=t=>n(o).published_date=t),type:"date",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.published_date}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.published_date,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"status",value:"Status *"}),b(l("select",{id:"status","onUpdate:modelValue":e[9]||(e[9]=t=>n(o).status=t),required:"",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.status}])},e[23]||(e[23]=[l("option",{value:"draft"},"Draft",-1),l("option",{value:"scheduled"},"Scheduled",-1),l("option",{value:"published"},"Published",-1),l("option",{value:"archived"},"Archived",-1)]),2),[[A,n(o).status]]),r(u,{message:n(o).errors.status,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"content_category",value:"Content Category"}),r(y,{id:"content_category",modelValue:n(o).content_category,"onUpdate:modelValue":e[10]||(e[10]=t=>n(o).content_category=t),type:"text",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.content_category}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.content_category,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"tags",value:"Tags"}),l("div",de,[l("div",ue,[l("div",{class:m(["flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md shadow-sm focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 min-h-12 transition-colors",{"border-red-500":n(o).errors.tags,"bg-gray-50":F.value}]),onClick:O},[(c(!0),g(x,null,w(D.value,(t,i)=>(c(),g("span",{key:i,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 border border-indigo-200 transition-all hover:bg-indigo-200 hover:scale-105"},[ee(f(t.trim())+" ",1),l("button",{type:"button",onClick:P(p=>E(i),["stop"]),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors",title:"Remove tag"},e[24]||(e[24]=[l("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ce)]))),128)),b(l("input",{ref_key:"tagInputRef",ref:C,type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>v.value=t),onKeydown:R,onFocus:e[12]||(e[12]=t=>F.value=!0),onBlur:e[13]||(e[13]=t=>F.value=!1),onInput:L,placeholder:"Type to add tags...",class:m(["flex-1 min-w-0 bg-transparent border-none outline-none py-1 px-2 text-sm placeholder-gray-400",{"opacity-50":n(o).processing}]),disabled:n(o).processing},null,42,me),[[V,v.value]]),v.value.trim()?(c(),g("button",{key:0,type:"button",onClick:e[14]||(e[14]=P((...t)=>B&&B(...t),["prevent","stop"])),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors p-1 rounded",title:"Add tag",disabled:n(o).processing},e[25]||(e[25]=[l("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,ge)):h("",!0)],2),k.value?(c(),g("div",pe,[l("div",fe,[e[26]||(e[26]=l("span",null,"Press Enter or Comma to add:",-1)),l("span",be,f(k.value),1)])])):h("",!0)]),M.value.length>0?(c(),g("div",ve,[e[27]||(e[27]=l("p",{class:"text-xs text-gray-500 mb-1"}," Common tags: ",-1)),l("div",ye,[(c(!0),g(x,null,w(M.value,(t,i)=>(c(),g("span",{key:i,onClick:p=>T(t),class:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors cursor-pointer inline-block",role:"button",tabindex:"0",onKeydown:[j(p=>T(t),["enter"]),j(P(p=>T(t),["prevent"]),["space"])]},f(t),41,_e))),128))])])):h("",!0)]),r(u,{message:n(o).errors.tags,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"notes",value:"Notes"}),b(l("textarea",{id:"notes","onUpdate:modelValue":e[15]||(e[15]=t=>n(o).notes=t),rows:"3",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.notes}])},null,2),[[V,n(o).notes]]),r(u,{message:n(o).errors.notes,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{for:"meta_description",value:"Meta Description"}),b(l("textarea",{id:"meta_description","onUpdate:modelValue":e[16]||(e[16]=t=>n(o).meta_description=t),rows:"2",maxlength:"255",class:m(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":n(o).errors.meta_description}])},null,2),[[V,n(o).meta_description]]),r(u,{message:n(o).errors.meta_description,class:"mt-2"},null,8,["message"]),l("p",xe,f(n(o).meta_description?n(o).meta_description.length:0)+"/255 characters ",1)]),l("div",null,[r(d,{for:"seo_keywords",value:"SEO Keywords"}),r(y,{id:"seo_keywords",modelValue:n(o).seo_keywords,"onUpdate:modelValue":e[17]||(e[17]=t=>n(o).seo_keywords=t),type:"text",maxlength:"255",class:m(["mt-1 block w-full",{"border-red-500":n(o).errors.seo_keywords}])},null,8,["modelValue","class"]),r(u,{message:n(o).errors.seo_keywords,class:"mt-2"},null,8,["message"]),e[28]||(e[28]=l("p",{class:"text-xs text-gray-500 mt-1"}," Separate keywords with commas ",-1))]),l("div",null,[r(d,{value:"Upload Image",class:"mb-2"}),a.contentPost.image?(c(),g("div",we,[e[29]||(e[29]=l("p",{class:"text-sm text-gray-600 mb-2"}," Current Image: ",-1)),l("img",{src:a.contentPost.image,alt:"Current content image",class:"max-w-full h-auto max-h-48 rounded-lg border",onerror:"this.style.display='none'"},null,8,he),e[30]||(e[30]=l("p",{class:"text-xs text-gray-500 mt-1"}," This image will be replaced if you upload a new one. ",-1))])):h("",!0),r(z,{modelValue:n(o).image,"onUpdate:modelValue":e[18]||(e[18]=t=>n(o).image=t),label:"Main Image","accept-types":["image"],multiple:!1,"max-size":10,description:"Drag & drop image here or click to browse","with-preview":!0,required:!1,error:n(o).errors.image},null,8,["modelValue","error"]),e[31]||(e[31]=l("p",{class:"text-xs text-gray-500 mt-2"}," Upload a single image file. Supported formats: JPG, PNG, GIF. ",-1)),r(u,{message:n(o).errors.image,class:"mt-2"},null,8,["message"])]),l("div",null,[r(d,{value:"Upload Additional Files",class:"mb-2"}),a.contentPost.media&&a.contentPost.media.length>0?(c(),g("div",ke,[e[32]||(e[32]=l("p",{class:"text-sm text-gray-600 mb-2"}," Current Files: ",-1)),l("div",Pe,[(c(!0),g(x,null,w(a.contentPost.media,t=>(c(),g("div",{key:t.id,class:"flex items-center justify-between p-2 bg-gray-50 rounded border"},[l("div",Ve,[l("span",Ce,f(t.original_name),1),l("span",Fe,"("+f(G(t.file_size))+")",1)]),l("a",{href:t.file_path,target:"_blank",class:"text-indigo-600 hover:text-indigo-800 text-sm"}," View ",8,De)]))),128))]),e[33]||(e[33]=l("p",{class:"text-xs text-gray-500 mt-1"}," These files will remain unless you delete them. ",-1))])):h("",!0),r(z,{modelValue:n(o).media,"onUpdate:modelValue":e[19]||(e[19]=t=>n(o).media=t),label:"Additional Files","accept-types":["image","pdf","xlsx","csv"],multiple:!0,"max-size":10,description:"Drag & drop files here or click to browse","with-preview":!1,required:!1,error:n(o).errors.media},null,8,["modelValue","error"]),e[34]||(e[34]=l("p",{class:"text-xs text-gray-500 mt-2"}," You can upload up to 10 files. Supported formats: JPG, PNG, GIF, PDF, DOC, DOCX, TXT. ",-1)),r(u,{message:n(o).errors.media,class:"mt-2"},null,8,["message"])]),l("div",Se,[l("button",{type:"button",onClick:Y,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Cancel "),l("button",{type:"submit",disabled:n(o).processing,class:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"},f(n(o).processing?"Updating...":"Update Content Post"),9,Te)])],32)])])])])]),_:1}))}};export{Be as default};
