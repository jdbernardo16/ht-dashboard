import{b as Y,m as b,j as W,d as Q,o as n,w as V,e as t,f as C,a as i,n as g,u as o,k as c,p as E,z as x,c as d,F as k,y as _,t as p,i as w,g as j,A as z,v as Z,q as M}from"./app-DMsrlBw0.js";import{_ as ee}from"./AuthenticatedLayout-CoyhxnNm.js";import{_ as u,a as h,b as m}from"./TextInput-FbyQ28m3.js";import{P as te}from"./PrimaryButton-CLiSzqXU.js";import{_ as se}from"./SecondaryButton--IEOdd-0.js";import{F as re}from"./FileUpload-Cxeb33nX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"font-semibold text-xl text-gray-800 leading-tight"},ae={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},ne={class:"border-b border-gray-200 pb-6"},de={class:"mt-4"},ue={class:"border-b border-gray-200 pb-6"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"border-b border-gray-200 pb-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe=["value"],fe=["value"],ye={class:"border-b border-gray-200 pb-6"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},be={class:"border-b border-gray-200 pb-6"},xe={class:"mt-1"},ke={class:"relative"},_e=["onClick"],we=["disabled"],he=["disabled"],Fe={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 p-2"},Ve={class:"text-sm text-gray-600 flex items-center justify-between"},Ce={class:"font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded"},Te={key:0,class:"mt-1 p-2 bg-gray-50 border border-gray-200 rounded-md"},Se={class:"flex flex-wrap gap-1"},Ue=["onClick","onKeydown"],Ae={class:"mt-4"},Be={class:"border-b border-gray-200 pb-6"},De={key:0,class:"mb-6"},Ee={class:"space-y-3"},Me={class:"flex items-center space-x-3"},qe={class:"flex-shrink-0"},Pe={class:"w-10 h-10 flex items-center justify-center rounded bg-gray-200"},Ie={class:"text-xs font-medium text-gray-600"},$e={class:"min-w-0 flex-1"},Ne={class:"text-sm font-medium text-gray-900 truncate"},je={class:"text-xs text-gray-500"},ze=["onClick","disabled"],Oe={class:"border-b border-gray-200 pb-6"},Ge={class:"space-y-4"},Ke={class:"flex items-center"},Re={key:0},Le={class:"flex items-center justify-end space-x-3 pt-6"},He={key:0},Je={key:1},st={__name:"Edit",props:{task:{type:Object,required:!0},users:{type:Array,default:()=>[]},goals:{type:Array,default:()=>[]}},setup(y){const l=y,O=a=>a?new Date(a).toISOString().split("T")[0]:"",s=Y({title:l.task.title||"",description:l.task.description||"",priority:l.task.priority||"",status:l.task.status||"",due_date:l.task.due_date?O(l.task.due_date):"",assigned_to:l.task.assigned_to?l.task.assigned_to.toString():"",category:l.task.category||"",estimated_hours:l.task.estimated_hours||"",actual_hours:l.task.actual_hours||"",tags:(()=>{if(Array.isArray(l.task.tags))return l.task.tags;if(typeof l.task.tags=="string")try{const a=JSON.parse(l.task.tags);return Array.isArray(a)?a:[]}catch{return l.task.tags.split(",").map(e=>e.trim()).filter(e=>e)}return[]})(),notes:l.task.notes||"",related_goal_id:l.task.related_goal_id||"",is_recurring:!!l.task.is_recurring,recurring_frequency:l.task.recurring_frequency||"",media:[]}),v=b(""),T=b(null),S=b(!1),F=b(""),q=b(["urgent","important","follow-up","review","meeting","documentation"]),U=W(()=>Array.isArray(s.tags)?s.tags.filter(a=>a&&a.trim()):[]),G=()=>{T.value&&T.value.focus()},P=()=>{const a=v.value.trim();F.value=a},I=a=>{const e=v.value.trim();a.key==="Enter"||a.key===","||a.keyCode===188?(a.preventDefault(),e&&A(e)):a.key==="Backspace"&&!e&&U.value.length>0&&(a.preventDefault(),N(U.value.length-1))},$=a=>{a?.preventDefault?.(),a?.stopPropagation?.();const e=v.value.trim();e&&A(e)},A=a=>{if(!a)return;const e=a.trim();e&&(s.tags.includes(e)||s.tags.push(e),v.value="",F.value="")},N=a=>{a>=0&&a<s.tags.length&&s.tags.splice(a,1)},B=a=>{A(a)},K=a=>{console.error("File upload error:",a)},R=()=>{console.log("Form data being submitted:",{status:s.status,priority:s.priority,title:s.title,tags:s.tags});const a=new FormData;Object.keys(s.data()).forEach(e=>{e==="tags"&&Array.isArray(s[e])?a.append(e,JSON.stringify(s[e])):e==="media"&&Array.isArray(s[e])?s[e].forEach(r=>{a.append("media[]",r)}):a.append(e,s[e])}),s.put(route("tasks.web.update",l.task.id),{data:a,preserveScroll:!0,onSuccess:()=>{console.log("Form submitted successfully"),M.visit(route("tasks.web.index"))},onError:e=>{console.error("Form errors:",e)}})},L=()=>{M.visit(route("tasks.web.index"))},H=a=>{const e=a.split(".");return e.length>1?e.pop().toUpperCase().substring(0,3):"FILE"},J=a=>{if(a===0)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,f)).toFixed(2))+" "+r[f]},X=a=>{confirm("Are you sure you want to remove this file?")&&M.delete(route("tasks.web.media.destroy",{task:l.task.id,media:a}),{preserveScroll:!0,onSuccess:()=>{const e=l.task.media.findIndex(r=>r.id===a);e!==-1&&l.task.media.splice(e,1)},onError:e=>{console.error("Error removing media:",e),alert("Failed to remove the file. Please try again.")}})};return(a,e)=>(n(),Q(ee,null,{header:V(()=>[t("h2",oe," Edit Task: "+p(y.task.title),1)]),default:V(()=>[t("div",null,[t("div",ae,[t("div",ie,[t("div",le,[t("form",{onSubmit:C(R,["prevent"]),class:"space-y-6"},[t("div",ne,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Basic Information ",-1)),t("div",null,[i(u,{for:"title",value:"Title *"}),i(h,{id:"title",modelValue:o(s).title,"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).title=r),type:"text",class:g(["mt-1 block w-full",{"border-red-500":o(s).errors.title}]),required:"",autofocus:""},null,8,["modelValue","class"]),i(m,{message:o(s).errors.title,class:"mt-2"},null,8,["message"])]),t("div",de,[i(u,{for:"description",value:"Description"}),c(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=r=>o(s).description=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.description}]),rows:"4"},null,2),[[E,o(s).description]]),i(m,{message:o(s).errors.description,class:"mt-2"},null,8,["message"])])]),t("div",ue,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Task Details ",-1)),t("div",ge,[t("div",null,[i(u,{for:"priority",value:"Priority *"}),c(t("select",{id:"priority","onUpdate:modelValue":e[2]||(e[2]=r=>o(s).priority=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.priority}]),required:""},e[21]||(e[21]=[t("option",{value:""}," Select Priority ",-1),t("option",{value:"low"},"Low",-1),t("option",{value:"medium"}," Medium ",-1),t("option",{value:"high"},"High",-1),t("option",{value:"urgent"}," Urgent ",-1)]),2),[[x,o(s).priority]]),i(m,{message:o(s).errors.priority,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"status",value:"Status *"}),c(t("select",{id:"status","onUpdate:modelValue":e[3]||(e[3]=r=>o(s).status=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.status}]),required:""},e[22]||(e[22]=[t("option",{value:""}," Select Status ",-1),t("option",{value:"pending"}," Pending ",-1),t("option",{value:"not_started"}," Not Started ",-1),t("option",{value:"in_progress"}," In Progress ",-1),t("option",{value:"completed"}," Completed ",-1),t("option",{value:"cancelled"}," Cancelled ",-1)]),2),[[x,o(s).status]]),i(m,{message:o(s).errors.status,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"due_date",value:"Due Date *"}),i(h,{id:"due_date",modelValue:o(s).due_date,"onUpdate:modelValue":e[4]||(e[4]=r=>o(s).due_date=r),type:"date",class:g(["mt-1 block w-full",{"border-red-500":o(s).errors.due_date}]),required:""},null,8,["modelValue","class"]),i(m,{message:o(s).errors.due_date,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"category",value:"Category"}),i(h,{id:"category",modelValue:o(s).category,"onUpdate:modelValue":e[5]||(e[5]=r=>o(s).category=r),type:"text",class:g(["mt-1 block w-full",{"border-red-500":o(s).errors.category}])},null,8,["modelValue","class"]),i(m,{message:o(s).errors.category,class:"mt-2"},null,8,["message"])])])]),t("div",me,[e[26]||(e[26]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Assignment ",-1)),t("div",ce,[t("div",null,[i(u,{for:"assigned_to",value:"Assigned To"}),c(t("select",{id:"assigned_to","onUpdate:modelValue":e[6]||(e[6]=r=>o(s).assigned_to=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.assigned_to}])},[e[24]||(e[24]=t("option",{value:""},"Unassigned",-1)),(n(!0),d(k,null,_(y.users,r=>(n(),d("option",{key:r.id,value:r.id},p(r.name),9,pe))),128))],2),[[x,o(s).assigned_to]]),i(m,{message:o(s).errors.assigned_to,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"related_goal_id",value:"Related Goal"}),c(t("select",{id:"related_goal_id","onUpdate:modelValue":e[7]||(e[7]=r=>o(s).related_goal_id=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.related_goal_id}])},[e[25]||(e[25]=t("option",{value:""},"No Goal",-1)),(n(!0),d(k,null,_(y.goals,r=>(n(),d("option",{key:r.id,value:r.id},p(r.title),9,fe))),128))],2),[[x,o(s).related_goal_id]]),i(m,{message:o(s).errors.related_goal_id,class:"mt-2"},null,8,["message"])])])]),t("div",ye,[e[27]||(e[27]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Time Tracking ",-1)),t("div",ve,[t("div",null,[i(u,{for:"estimated_hours",value:"Estimated Hours"}),i(h,{id:"estimated_hours",modelValue:o(s).estimated_hours,"onUpdate:modelValue":e[8]||(e[8]=r=>o(s).estimated_hours=r),type:"number",step:"0.5",min:"0",class:g(["mt-1 block w-full",{"border-red-500":o(s).errors.estimated_hours}])},null,8,["modelValue","class"]),i(m,{message:o(s).errors.estimated_hours,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"actual_hours",value:"Actual Hours"}),i(h,{id:"actual_hours",modelValue:o(s).actual_hours,"onUpdate:modelValue":e[9]||(e[9]=r=>o(s).actual_hours=r),type:"number",step:"0.5",min:"0",class:g(["mt-1 block w-full",{"border-red-500":o(s).errors.actual_hours}])},null,8,["modelValue","class"]),i(m,{message:o(s).errors.actual_hours,class:"mt-2"},null,8,["message"])])])]),t("div",be,[e[33]||(e[33]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Additional Details ",-1)),t("div",null,[i(u,{for:"tags",value:"Tags"}),t("div",xe,[t("div",ke,[t("div",{class:g(["flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md shadow-sm focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 min-h-12 transition-colors",{"border-red-500":o(s).errors.tags,"bg-gray-50":S.value}]),onClick:G},[(n(!0),d(k,null,_(U.value,(r,f)=>(n(),d("span",{key:f,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 border border-indigo-200 transition-all hover:bg-indigo-200 hover:scale-105"},[j(p(r.trim())+" ",1),t("button",{type:"button",onClick:C(D=>N(f),["stop"]),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors",title:"Remove tag"},e[28]||(e[28]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,_e)]))),128)),c(t("input",{ref_key:"tagInputRef",ref:T,type:"text","onUpdate:modelValue":e[10]||(e[10]=r=>v.value=r),onKeydown:e[11]||(e[11]=(...r)=>I&&I(...r)),onFocus:e[12]||(e[12]=r=>S.value=!0),onBlur:e[13]||(e[13]=r=>S.value=!1),onInput:e[14]||(e[14]=(...r)=>P&&P(...r)),placeholder:"Type to add tags...",class:g(["flex-1 min-w-0 bg-transparent border-none outline-none py-1 px-2 text-sm placeholder-gray-400",{"opacity-50":o(s).processing}]),disabled:o(s).processing},null,42,we),[[E,v.value]]),v.value.trim()?(n(),d("button",{key:0,type:"button",onClick:e[15]||(e[15]=C((...r)=>$&&$(...r),["prevent","stop"])),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors p-1 rounded",title:"Add tag",disabled:o(s).processing},e[29]||(e[29]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,he)):w("",!0)],2),F.value?(n(),d("div",Fe,[t("div",Ve,[e[30]||(e[30]=t("span",null,"Press Enter or Comma to add:",-1)),t("span",Ce,p(F.value),1)])])):w("",!0)]),q.value.length>0?(n(),d("div",Te,[e[31]||(e[31]=t("p",{class:"text-xs text-gray-500 mb-1"}," Common tags: ",-1)),t("div",Se,[(n(!0),d(k,null,_(q.value,(r,f)=>(n(),d("span",{key:f,onClick:D=>B(r),class:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors cursor-pointer inline-block",role:"button",tabindex:"0",onKeydown:[z(D=>B(r),["enter"]),z(C(D=>B(r),["prevent"]),["space"])]},p(r),41,Ue))),128))])])):w("",!0),e[32]||(e[32]=t("p",{class:"mt-1 text-xs text-gray-500"}," Press Enter or Comma to add tags. ",-1))]),i(m,{message:o(s).errors.tags,class:"mt-2"},null,8,["message"])]),t("div",Ae,[i(u,{for:"notes",value:"Notes"}),c(t("textarea",{id:"notes","onUpdate:modelValue":e[16]||(e[16]=r=>o(s).notes=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.notes}]),rows:"3"},null,2),[[E,o(s).notes]]),i(m,{message:o(s).errors.notes,class:"mt-2"},null,8,["message"])])]),t("div",Be,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," File Attachments ",-1)),y.task.media&&y.task.media.length>0?(n(),d("div",De,[i(u,{value:"Existing Files",class:"mb-2"}),t("div",Ee,[(n(!0),d(k,null,_(y.task.media,r=>(n(),d("div",{key:r.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border"},[t("div",Me,[t("div",qe,[t("div",Pe,[t("span",Ie,p(H(r.original_name)),1)])]),t("div",$e,[t("p",Ne,p(r.original_name),1),t("p",je,p(J(r.file_size)),1)])]),t("button",{type:"button",onClick:f=>X(r.id),class:"ml-3 text-red-600 hover:text-red-800",title:"Remove file",disabled:o(s).processing},e[34]||(e[34]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ze)]))),128))])])):w("",!0),t("div",null,[i(u,{value:"Upload New Files",class:"mb-2"}),i(re,{modelValue:o(s).media,"onUpdate:modelValue":e[17]||(e[17]=r=>o(s).media=r),multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt",maxFiles:10,maxSize:10*1024*1024,title:"Drag & drop files here or click to browse",description:"Supports images, PDFs, and documents (max 10MB each)",onError:K},null,8,["modelValue"]),i(m,{message:o(s).errors.media,class:"mt-2"},null,8,["message"]),e[35]||(e[35]=t("p",{class:"text-xs text-gray-500 mt-2"}," You can upload up to 10 files. Supported formats: JPG, PNG, GIF, PDF, DOC, DOCX, TXT. ",-1))])]),t("div",Oe,[e[38]||(e[38]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Recurring Task ",-1)),t("div",Ge,[t("div",Ke,[c(t("input",{id:"is_recurring","onUpdate:modelValue":e[18]||(e[18]=r=>o(s).is_recurring=r),type:"checkbox",class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[Z,o(s).is_recurring]]),i(u,{for:"is_recurring",value:"This is a recurring task",class:"ml-2"})]),o(s).is_recurring?(n(),d("div",Re,[i(u,{for:"recurring_frequency",value:"Frequency"}),c(t("select",{id:"recurring_frequency","onUpdate:modelValue":e[19]||(e[19]=r=>o(s).recurring_frequency=r),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.recurring_frequency}])},e[37]||(e[37]=[t("option",{value:""}," Select Frequency ",-1),t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"}," Weekly ",-1),t("option",{value:"monthly"}," Monthly ",-1),t("option",{value:"yearly"}," Yearly ",-1)]),2),[[x,o(s).recurring_frequency]]),i(m,{message:o(s).errors.recurring_frequency,class:"mt-2"},null,8,["message"])])):w("",!0)])]),t("div",Le,[i(se,{type:"button",onClick:L,disabled:o(s).processing},{default:V(()=>e[39]||(e[39]=[j(" Cancel ",-1)])),_:1,__:[39]},8,["disabled"]),i(te,{type:"submit",disabled:o(s).processing,class:g({"opacity-50":o(s).processing})},{default:V(()=>[o(s).processing?(n(),d("span",He,"Updating...")):(n(),d("span",Je,"Update Task"))]),_:1},8,["disabled","class"])])],32)])])])])]),_:1}))}};export{st as default};
