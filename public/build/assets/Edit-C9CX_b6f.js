import{m as v,j as U,y as F,c as d,o as n,e,i as p,n as M,F as q,z as L,t as g,s as _,b as P,d as H,w as A,f as O,a as K,u as o,k as x,p as w,q as z,g as S}from"./app-B2jK0_72.js";import{_ as R}from"./AuthenticatedLayout-U9Pl7f8v.js";const Q={class:"relative"},G={class:"relative"},J=["value","placeholder","disabled"],W={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},X={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-auto"},Y={class:"py-1"},Z=["onMousedown"],ee={class:"font-medium"},te={class:"text-sm text-gray-500"},se={key:1,class:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border border-gray-200"},oe={class:"font-medium"},re={__name:"Autocomplete",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Search customers..."},disabled:{type:Boolean,default:!1},inputClass:{type:String,default:""},allowCreate:{type:Boolean,default:!0}},emits:["update:modelValue","select","create"],setup(y,{expose:c,emit:C}){const s=y,f=C,k=v(null),m=v(""),i=v([]),a=v(!1),t=v(!1),r=v(-1),b=v(null),D=U(()=>b.value?b.value.name:m.value),V=U(()=>s.allowCreate&&m.value.length>2&&!i.value.some(l=>l.name.toLowerCase().includes(m.value.toLowerCase()))),E=async l=>{if(l.length<2){i.value=[];return}t.value=!0;try{const u=await _.get("/api/clients/search",{search:l});i.value=u.data}catch(u){console.error("Error fetching suggestions:",u),i.value=[],u.response?.status===401&&(a.value=!1)}finally{t.value=!1}},N=l=>{m.value=l.target.value,b.value=null,f("update:modelValue",""),r.value=-1,clearTimeout(window.suggestionTimeout),window.suggestionTimeout=setTimeout(()=>{E(m.value)},300)},T=()=>{setTimeout(()=>{a.value=!1},200)},I=l=>{if(a.value)switch(l.key){case"ArrowDown":l.preventDefault(),r.value=Math.min(r.value+1,i.value.length+(V.value?1:0)-1);break;case"ArrowUp":l.preventDefault(),r.value=Math.max(r.value-1,-1);break;case"Enter":l.preventDefault(),r.value>=0&&(r.value<i.value.length?B(i.value[r.value]):V.value&&$());break;case"Escape":a.value=!1,r.value=-1;break}},B=l=>{b.value=l,m.value="",f("update:modelValue",l.id),f("select",l),a.value=!1,i.value=[]},$=async()=>{if(s.allowCreate)try{const u=(await _.post("/api/clients",{first_name:m.value.split(" ")[0],last_name:m.value.split(" ").slice(1).join(" ")||"Customer",email:null})).data;b.value=u,m.value="",f("update:modelValue",u.id),f("select",u),f("create",u),a.value=!1,i.value=[]}catch(l){console.error("Error creating customer:",l),l.response?.status===422?l.response.data.errors.email?alert("Please provide a valid email address for the new customer."):alert("Please check the customer information and try again."):l.response?.status===401?a.value=!1:alert("Failed to create new customer. Please try again.")}};return F(()=>s.modelValue,l=>{l||(b.value=null,m.value="")}),c({focus:()=>{k.value?.focus()}}),(l,u)=>(n(),d("div",Q,[e("div",G,[e("input",{type:"text",value:D.value,onInput:N,onFocus:u[0]||(u[0]=h=>a.value=!0),onBlur:T,onKeydown:I,placeholder:y.placeholder,disabled:y.disabled,class:M(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",y.inputClass]),ref_key:"inputRef",ref:k},null,42,J),t.value?(n(),d("div",W,u[1]||(u[1]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):p("",!0)]),a.value&&i.value.length>0?(n(),d("div",X,[e("ul",Y,[(n(!0),d(q,null,L(i.value,(h,j)=>(n(),d("li",{key:h.id,onMousedown:je=>B(h),class:M(["px-4 py-2 cursor-pointer hover:bg-gray-100 transition-colors",{"bg-gray-100":j===r.value,"text-blue-600":j===r.value}])},[e("div",ee,g(h.name),1),e("div",te,g(h.email),1)],42,Z))),128))])])):p("",!0),a.value&&V.value?(n(),d("div",se,[e("div",{onMousedown:$,class:M(["px-4 py-2 cursor-pointer hover:bg-gray-100 transition-colors border-t border-gray-100",{"bg-gray-100":r.value===i.value.length,"text-blue-600":r.value===i.value.length}])},[e("div",oe,' + Add new customer: "'+g(m.value)+'" ',1)],34)])):p("",!0)]))}},le={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ae={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},ne={class:"p-6 text-gray-900"},ie={class:"bg-gray-50 rounded-xl p-6"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"md:col-span-2"},ce={key:0,class:"mt-2 text-sm text-red-600"},me={key:0,class:"mt-2 text-sm text-red-600"},pe={class:"relative"},ge={key:0,class:"mt-2 text-sm text-red-600"},fe={class:"mt-6"},ve={key:0,class:"mt-2 text-sm text-red-600"},xe={class:"bg-gray-50 rounded-xl p-6"},ye={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},be={key:0,class:"mt-2 text-sm text-red-600"},he={key:0,class:"mt-2 text-sm text-red-600"},we={key:0,class:"mt-2 text-sm text-red-600"},ke={class:"bg-gray-50 rounded-xl p-6"},_e={key:0,class:"mt-2 text-sm text-red-600"},Ce={class:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200"},Ve=["disabled"],Me=["disabled"],Se={key:0,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Be={key:1,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ze={__name:"Edit",props:{sale:{type:Object,required:!0}},setup(y){const c=y,C=a=>a?new Date(a).toISOString().split("T")[0]:"",s=P({client_id:c.sale.client_id||"",product_name:c.sale.product_name||"",description:c.sale.description||"",amount:c.sale.amount||0,sale_date:C(c.sale.sale_date),status:c.sale.status||"pending",payment_method:c.sale.payment_method||"cash",notes:c.sale.notes||""}),f=()=>{s.put(`/sales/${c.sale.id}`,{preserveScroll:!0,onSuccess:()=>{_.visit(`/sales/${c.sale.id}`)},onError:a=>{console.error("Error updating sale:",a)}})},k=a=>{console.log("Client selected:",a)},m=a=>{console.log("Client created:",a)},i=()=>{_.visit(`/sales/${c.sale.id}`)};return(a,t)=>(n(),H(R,null,{header:A(()=>[e("div",{class:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4"},[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 leading-tight"}," Edit Sale "),e("p",{class:"mt-1 text-sm text-gray-500"}," Update the sales transaction details ")],-1)),e("div",{class:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-2 sm:space-y-0 mt-4 lg:mt-0"},[e("button",{onClick:i,class:"inline-flex items-center justify-center px-4 py-2 bg-white border border-gray-300 rounded-lg font-medium text-sm text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200"},t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),S(" Back to Sales ",-1)]))])])]),default:A(()=>[e("div",le,[e("div",ae,[t[27]||(t[27]=e("div",{class:"bg-gradient-to-r from-green-500 to-emerald-600 px-6 py-4"},[e("h2",{class:"text-xl font-semibold text-white"}," Sale Information "),e("p",{class:"text-green-100 text-sm mt-1"}," Update the details for this sales transaction ")],-1)),e("div",ne,[e("form",{onSubmit:O(f,["prevent"]),class:"space-y-8"},[e("div",ie,[t[15]||(t[15]=e("div",{class:"flex items-center mb-6"},[e("div",{class:"flex-shrink-0"},[e("div",{class:"inline-flex items-center justify-center w-10 h-10 bg-green-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])])]),e("div",{class:"ml-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Basic Information "),e("p",{class:"text-sm text-gray-500"}," Enter client and product details ")])],-1)),e("div",de,[e("div",ue,[t[10]||(t[10]=e("label",{for:"client_id",class:"block text-sm font-medium text-gray-700 mb-2"},"Client *",-1)),K(re,{id:"client_id",modelValue:o(s).client_id,"onUpdate:modelValue":t[0]||(t[0]=r=>o(s).client_id=r),placeholder:"Search for a client by name or email...",class:"w-full",onSelect:k,onCreate:m},null,8,["modelValue"]),o(s).errors.client_id?(n(),d("p",ce,g(o(s).errors.client_id),1)):p("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{for:"product_name",class:"block text-sm font-medium text-gray-700 mb-2"},"Product Name *",-1)),x(e("input",{type:"text",id:"product_name","onUpdate:modelValue":t[1]||(t[1]=r=>o(s).product_name=r),required:"",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 transition-colors"},null,512),[[w,o(s).product_name]]),o(s).errors.product_name?(n(),d("p",me,g(o(s).errors.product_name),1)):p("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{for:"amount",class:"block text-sm font-medium text-gray-700 mb-2"},"Amount *",-1)),e("div",pe,[t[12]||(t[12]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("span",{class:"text-gray-500 sm:text-sm"},"$")],-1)),x(e("input",{type:"number",id:"amount","onUpdate:modelValue":t[2]||(t[2]=r=>o(s).amount=r),required:"",min:"0",step:"0.01",class:"mt-1 block w-full pl-7 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 transition-colors"},null,512),[[w,o(s).amount]])]),o(s).errors.amount?(n(),d("p",ge,g(o(s).errors.amount),1)):p("",!0)])]),e("div",fe,[t[14]||(t[14]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),x(e("textarea",{id:"description","onUpdate:modelValue":t[3]||(t[3]=r=>o(s).description=r),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 transition-colors"},null,512),[[w,o(s).description]]),o(s).errors.description?(n(),d("p",ve,g(o(s).errors.description),1)):p("",!0)])]),e("div",xe,[t[21]||(t[21]=e("div",{class:"flex items-center mb-6"},[e("div",{class:"flex-shrink-0"},[e("div",{class:"inline-flex items-center justify-center w-10 h-10 bg-green-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])])]),e("div",{class:"ml-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Transaction Details "),e("p",{class:"text-sm text-gray-500"}," Configure sale date, status, and payment method ")])],-1)),e("div",ye,[e("div",null,[t[16]||(t[16]=e("label",{for:"sale_date",class:"block text-sm font-medium text-gray-700 mb-2"},"Sale Date *",-1)),x(e("input",{type:"date",id:"sale_date","onUpdate:modelValue":t[4]||(t[4]=r=>o(s).sale_date=r),required:"",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 transition-colors"},null,512),[[w,o(s).sale_date]]),o(s).errors.sale_date?(n(),d("p",be,g(o(s).errors.sale_date),1)):p("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-2"},"Status *",-1)),x(e("select",{id:"status","onUpdate:modelValue":t[5]||(t[5]=r=>o(s).status=r),required:"",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 transition-colors"},t[17]||(t[17]=[e("option",{value:"pending"},"Pending",-1),e("option",{value:"completed"}," Completed ",-1),e("option",{value:"cancelled"}," Cancelled ",-1)]),512),[[z,o(s).status]]),o(s).errors.status?(n(),d("p",he,g(o(s).errors.status),1)):p("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{for:"payment_method",class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Method *",-1)),x(e("select",{id:"payment_method","onUpdate:modelValue":t[6]||(t[6]=r=>o(s).payment_method=r),required:"",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 transition-colors"},t[19]||(t[19]=[e("option",{value:"cash"},"Cash",-1),e("option",{value:"card"},"Card",-1),e("option",{value:"online"},"Online",-1)]),512),[[z,o(s).payment_method]]),o(s).errors.payment_method?(n(),d("p",we,g(o(s).errors.payment_method),1)):p("",!0)])])]),e("div",ke,[t[23]||(t[23]=e("div",{class:"flex items-center mb-6"},[e("div",{class:"flex-shrink-0"},[e("div",{class:"inline-flex items-center justify-center w-10 h-10 bg-green-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])]),e("div",{class:"ml-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Additional Information "),e("p",{class:"text-sm text-gray-500"}," Add any extra notes or details about this sale ")])],-1)),e("div",null,[t[22]||(t[22]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),x(e("textarea",{id:"notes","onUpdate:modelValue":t[7]||(t[7]=r=>o(s).notes=r),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 px-3 py-2 transition-colors",placeholder:"Add any additional notes or special instructions..."},null,512),[[w,o(s).notes]]),o(s).errors.notes?(n(),d("p",_e,g(o(s).errors.notes),1)):p("",!0)])]),e("div",Ce,[e("button",{type:"button",onClick:i,class:"inline-flex items-center justify-center px-6 py-3 bg-white border border-gray-300 rounded-lg font-medium text-sm text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200",disabled:o(s).processing},t[24]||(t[24]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),S(" Cancel ",-1)]),8,Ve),e("button",{type:"submit",disabled:o(s).processing,class:"inline-flex items-center justify-center px-6 py-3 bg-green-600 border border-transparent rounded-lg font-medium text-sm text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50"},[o(s).processing?p("",!0):(n(),d("svg",Se,t[25]||(t[25]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))),o(s).processing?(n(),d("svg",Be,t[26]||(t[26]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):p("",!0),S(" "+g(o(s).processing?"Updating...":"Update Sale"),1)],8,Me)])],32)])])])]),_:1}))}};export{ze as default};
