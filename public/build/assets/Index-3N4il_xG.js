import{m,j as y,s as le,x as $,d as ae,o as r,w as d,e as t,a as T,c as i,i as O,k as f,p as S,F as x,y as k,t as n,z as F,g as M,n as A,q as u}from"./app-DMsrlBw0.js";import{_ as re}from"./AuthenticatedLayout-CoyhxnNm.js";import{_ as ie,a as ne}from"./Pagination-CBc77TNp.js";import{_ as de}from"./FormModal-C8My_P34.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-Dm6rggBr.js";const ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ge={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},me={class:"lg:col-span-2"},fe={class:"relative"},pe=["value"],be=["value"],ve={class:"mt-4"},ye=["aria-expanded"],xe={key:0,class:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ke=["value"],he={class:"mt-6 flex flex-col sm:flex-row gap-3 justify-end"},we=["disabled"],_e={key:0,class:"bg-white rounded-lg shadow-sm p-6"},Ce={class:"animate-pulse space-y-4"},Te={class:"space-y-3"},Se={key:1,class:"bg-white rounded-lg shadow-sm p-12 text-center"},Fe={key:2,class:"bg-white rounded-lg shadow-sm p-12 text-center"},Me={key:3,class:"bg-white shadow-sm rounded-lg overflow-hidden"},Ae={class:"relative"},Ee={key:0,class:"absolute inset-0 bg-white bg-opacity-50 z-10 flex items-center justify-center"},je={class:"font-medium text-gray-900"},$e={__name:"Index",props:{tasks:{type:Object,required:!0},users:{type:Array,default:()=>[]},goals:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})}},setup(H){const a=H,g=m(!1),E=m(!1),p=m(!1),j=m(!1),h=m({}),l=m({search:a.filters.search||"",status:a.filters.status||"",priority:a.filters.priority||"",assigned_to:a.filters.assigned_to||"",date_from:a.filters.date_from||"",date_to:a.filters.date_to||""}),V=[{value:"pending",label:"Pending"},{value:"not_started",label:"Not Started"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],q=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"urgent",label:"Urgent"}],I=[{key:"id",label:"ID",sortable:!0},{key:"title",label:"Title",sortable:!0},{key:"priority",label:"Priority",sortable:!0},{key:"status",label:"Status",sortable:!0},{key:"due_date",label:"Due Date",type:"date",sortable:!0},{key:"assigned_to",label:"Assigned To",sortable:!0},{key:"estimated_hours",label:"Est. Hours",sortable:!0}],z=[{value:"pending",label:"Pending"},{value:"not_started",label:"Not Started"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],w=[{name:"title",label:"Title",type:"text",required:!0},{name:"description",label:"Description",type:"textarea",required:!1},{name:"priority",label:"Priority",type:"select",required:!0,options:q},{name:"status",label:"Status",type:"select",required:!0,options:V},{name:"due_date",label:"Due Date",type:"date",required:!0},{name:"assigned_to",label:"Assigned To",type:"select",required:!1,options:[]},{name:"category",label:"Category",type:"text",required:!1},{name:"estimated_hours",label:"Estimated Hours",type:"number",required:!1,min:0,step:.5},{name:"actual_hours",label:"Actual Hours",type:"number",required:!1,min:0,step:.5}],v=y(()=>a.tasks.data||[]),_=y(()=>Object.values(l.value).some(o=>o&&o!=="")),D=y(()=>a.users.map(o=>({value:o.id,label:o.full_name||o.name}))),L=y(()=>a.goals.map(o=>({value:o.id,label:o.title}))),C=()=>{const o=w.find(s=>s.name==="assigned_to");o&&(o.options=D.value);const e=w.find(s=>s.name==="related_goal_id");e&&(e.options=L.value)},c=async()=>{g.value=!0;try{const o={};Object.keys(l.value).forEach(e=>{l.value[e]&&(o[e]=l.value[e])}),u.get("/tasks",o,{preserveState:!0,preserveScroll:!0,only:["tasks","filters"],onError:e=>{console.error("Error fetching tasks:",e)}})}catch(o){console.error("Error fetching tasks:",o)}finally{g.value=!1}},N=()=>{u.visit("/tasks/create")},G=o=>{u.visit(`/tasks/${o.id}/edit`)},J=o=>{u.visit(`/tasks/${o.id}`)},K=async o=>{if(confirm("Are you sure you want to delete this task?"))try{await u.delete(`/tasks/${o.id}`),await c()}catch(e){console.error("Error deleting task:",e)}},Q=async o=>{g.value=!0;try{o.tags&&(o.tags=o.tags.split(",").map(e=>e.trim()).filter(e=>e)),o.is_recurring!==void 0&&(o.is_recurring=!!o.is_recurring),j.value?await u.put(`/tasks/${h.value.id}`,o):await u.post("/tasks",o),await c(),P()}catch(e){if(e.response?.status===422){const s=e.response.data.errors;formModal.value&&formModal.value.setErrors(s)}else console.error("Error saving task:",e)}finally{g.value=!1}},P=()=>{E.value=!1,h.value={},formModal.value&&formModal.value.resetForm()},R=()=>{c()},U=()=>{l.value={search:"",status:"",priority:"",assigned_to:"",date_from:"",date_to:""},c()},W=o=>{u.visit(o,{preserveState:!0,preserveScroll:!0,only:["tasks","users","goals","filters"]})};let B=null;const X=()=>{clearTimeout(B),B=setTimeout(()=>{c()},300)},b=()=>{c()},Y=o=>new Date(o).toLocaleDateString(),Z=o=>o.charAt(0).toUpperCase()+o.slice(1).replace("_"," "),ee=o=>o.charAt(0).toUpperCase()+o.slice(1),te=o=>({pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",se=o=>({low:"bg-gray-100 text-gray-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",oe=(o,e)=>{if(e==="completed"||e==="cancelled")return"";const s=new Date;return new Date(o)<s?"text-red-600 font-medium":""};return le(()=>{C()}),$(()=>a.users,C,{immediate:!0}),$(()=>a.goals,C,{immediate:!0}),(o,e)=>(r(),ae(re,null,{header:d(()=>e[7]||(e[7]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Task Management ",-1)])),default:d(()=>[t("div",null,[t("div",ue,[t("div",ge,[t("div",ce,[t("div",me,[e[9]||(e[9]=t("label",{for:"search",class:"block text-sm font-medium text-gray-700 mb-1"}," Search tasks ",-1)),t("div",fe,[e[8]||(e[8]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),f(t("input",{id:"search","onUpdate:modelValue":e[0]||(e[0]=s=>l.value.search=s),type:"text",placeholder:"Search tasks...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",onInput:X,"aria-describedby":"search-description"},null,544),[[S,l.value.search]])]),e[10]||(e[10]=t("p",{id:"search-description",class:"mt-1 text-xs text-gray-500"}," Search by title, description, or assignee ",-1))]),t("div",null,[e[12]||(e[12]=t("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-1"}," Status ",-1)),f(t("select",{id:"status","onUpdate:modelValue":e[1]||(e[1]=s=>l.value.status=s),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onChange:b},[e[11]||(e[11]=t("option",{value:""},"All Status",-1)),(r(),i(x,null,k(V,s=>t("option",{key:s.value,value:s.value},n(s.label),9,pe)),64))],544),[[F,l.value.status]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"priority",class:"block text-sm font-medium text-gray-700 mb-1"}," Priority ",-1)),f(t("select",{id:"priority","onUpdate:modelValue":e[2]||(e[2]=s=>l.value.priority=s),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onChange:b},[e[13]||(e[13]=t("option",{value:""},"All Priorities",-1)),(r(),i(x,null,k(q,s=>t("option",{key:s.value,value:s.value},n(s.label),9,be)),64))],544),[[F,l.value.priority]])])]),t("div",ve,[t("button",{onClick:e[3]||(e[3]=s=>p.value=!p.value),class:"text-sm text-indigo-600 hover:text-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-expanded":p.value},n(p.value?"Hide":"Show")+" advanced filters ",9,ye)]),p.value?(r(),i("div",xe,[t("div",null,[e[16]||(e[16]=t("label",{for:"assigned_to",class:"block text-sm font-medium text-gray-700 mb-1"}," Assigned To ",-1)),f(t("select",{id:"assigned_to","onUpdate:modelValue":e[4]||(e[4]=s=>l.value.assigned_to=s),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onChange:b},[e[15]||(e[15]=t("option",{value:""},"All Users",-1)),(r(!0),i(x,null,k(D.value,s=>(r(),i("option",{key:s.value,value:s.value},n(s.label),9,ke))),128))],544),[[F,l.value.assigned_to]])]),t("div",null,[e[17]||(e[17]=t("label",{for:"date_from",class:"block text-sm font-medium text-gray-700 mb-1"}," Date From ",-1)),f(t("input",{id:"date_from","onUpdate:modelValue":e[5]||(e[5]=s=>l.value.date_from=s),type:"date",class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onChange:b},null,544),[[S,l.value.date_from]])]),t("div",null,[e[18]||(e[18]=t("label",{for:"date_to",class:"block text-sm font-medium text-gray-700 mb-1"}," Date To ",-1)),f(t("input",{id:"date_to","onUpdate:modelValue":e[6]||(e[6]=s=>l.value.date_to=s),type:"date",class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onChange:b},null,544),[[S,l.value.date_to]])])])):O("",!0),t("div",he,[t("button",{onClick:U,disabled:!_.value,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Clear all filters"}," Clear Filters ",8,we),t("button",{onClick:R,class:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Apply filters"}," Apply Filters ")])]),g.value&&v.value.length===0?(r(),i("div",_e,[t("div",Ce,[e[19]||(e[19]=t("div",{class:"h-4 bg-gray-200 rounded w-1/4"},null,-1)),t("div",Te,[(r(),i(x,null,k(5,s=>t("div",{key:s,class:"h-12 bg-gray-200 rounded"})),64))])])])):v.value.length===0&&!_.value?(r(),i("div",Se,[e[21]||(e[21]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),e[22]||(e[22]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"}," No tasks yet ",-1)),e[23]||(e[23]=t("p",{class:"mt-1 text-sm text-gray-500"}," Get started by creating your first task. ",-1)),t("div",{class:"mt-6"},[t("button",{onClick:N,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Create new task"},e[20]||(e[20]=[t("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" New Task ",-1)]))])])):v.value.length===0&&_.value?(r(),i("div",Fe,[e[24]||(e[24]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),e[25]||(e[25]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"}," No tasks found ",-1)),e[26]||(e[26]=t("p",{class:"mt-1 text-sm text-gray-500"}," Try adjusting your search criteria or clear filters. ",-1)),t("div",{class:"mt-6"},[t("button",{onClick:U,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Clear filters"}," Clear Filters ")])])):(r(),i("div",Me,[t("div",Ae,[g.value?(r(),i("div",Ee,e[27]||(e[27]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)]))):O("",!0),T(ie,{data:v.value,columns:I,filters:z,onCreate:N,onView:J,onEdit:G,onDelete:K,"aria-label":"Tasks list"},{title:d(({item:s})=>[t("div",je,n(s.title),1)]),priority:d(({item:s})=>[t("span",{class:A([se(s.priority),"px-2 py-1 text-xs font-medium rounded-full"])},n(ee(s.priority)),3)]),status:d(({item:s})=>[t("span",{class:A([te(s.status),"px-2 py-1 text-xs font-medium rounded-full"])},n(Z(s.status)),3)]),due_date:d(({item:s})=>[t("span",{class:A([oe(s.due_date,s.status),"text-sm font-medium"])},n(Y(s.due_date)),3)]),assigned_to:d(({item:s})=>[M(n(s.assigned_to?.full_name||s.assigned_to?.name||"Unassigned"),1)]),estimated_hours:d(({item:s})=>[M(n(s.estimated_hours||"-")+" hrs ",1)]),_:1},8,["data"])]),T(ne,{links:a.tasks.links,from:a.tasks.from,to:a.tasks.to,total:a.tasks.total,onNavigate:W,class:"border-t border-gray-200"},null,8,["links","from","to","total"])]))])]),T(de,{show:E.value,title:j.value?"Edit Task":"Create New Task",fields:w,"initial-data":h.value,loading:g.value,onClose:P,onSubmit:Q,ref:"formModal"},null,8,["show","title","initial-data","loading"])]),_:1}))}};export{$e as default};
