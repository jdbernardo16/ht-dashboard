import{b as Y,m as x,j as W,d as Q,o as n,w as C,e as t,f as F,a as i,n as g,u as r,k as c,p as E,q as b,c as d,F as k,z as _,t as p,i as w,g as j,A as O,v as Z,s as P}from"./app-CxJ0vpa7.js";import{_ as ee}from"./AuthenticatedLayout-Bp61g_Pn.js";import{_ as u,a as T,b as m}from"./TextInput-BUSJGHhQ.js";import{P as te}from"./PrimaryButton-Bx_okGQM.js";import{_ as se}from"./SecondaryButton-DypRYoIB.js";import{F as oe}from"./FileUpload-D7VkcLdN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"font-semibold text-xl text-gray-800 leading-tight"},ae={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},ne={class:"border-b border-gray-200 pb-6"},de={class:"mt-4"},ue={class:"border-b border-gray-200 pb-6"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"border-b border-gray-200 pb-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe=["value"],fe=["value"],ve={class:"border-b border-gray-200 pb-6"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},be={class:"border-b border-gray-200 pb-6"},xe={class:"mt-1"},ke={class:"relative"},_e=["onClick"],we=["disabled"],he=["disabled"],Ce={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 p-2"},Fe={class:"text-sm text-gray-600 flex items-center justify-between"},Te={class:"font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded"},Se={key:0,class:"mt-1 p-2 bg-gray-50 border border-gray-200 rounded-md"},Ve={class:"flex flex-wrap gap-1"},Me=["onClick","onKeydown"],Ue={class:"mt-4"},Ae={class:"border-b border-gray-200 pb-6"},Be={key:0,class:"mb-6"},Ee={class:"space-y-3"},Pe={class:"flex items-center space-x-3"},De={class:"flex-shrink-0"},qe={class:"w-10 h-10 flex items-center justify-center rounded bg-gray-200"},Ie={class:"text-xs font-medium text-gray-600"},$e={class:"min-w-0 flex-1"},Ne={class:"text-sm font-medium text-gray-900 truncate"},je={class:"text-xs text-gray-500"},Oe=["onClick","disabled"],Ge={class:"border-b border-gray-200 pb-6"},ze={class:"space-y-4"},Ke={class:"flex items-center"},Re={key:0},Le={class:"flex items-center justify-end space-x-3 pt-6"},He={key:0},Je={key:1},st={__name:"Edit",props:{task:{type:Object,required:!0},users:{type:Array,default:()=>[]},goals:{type:Array,default:()=>[]}},setup(v){const l=v,G=a=>a?new Date(a).toISOString().split("T")[0]:"",s=Y({title:l.task.title||"",description:l.task.description||"",priority:l.task.priority||"",status:l.task.status||"",due_date:l.task.due_date?G(l.task.due_date):"",assigned_to:l.task.assigned_to?l.task.assigned_to.toString():"",category:l.task.category||"",estimated_hours:l.task.estimated_hours||"",actual_hours:l.task.actual_hours||"",tags:(()=>{if(Array.isArray(l.task.tags))return l.task.tags;if(typeof l.task.tags=="string")try{const a=JSON.parse(l.task.tags);return Array.isArray(a)?a:[]}catch{return l.task.tags.split(",").map(e=>e.trim()).filter(e=>e)}return[]})(),notes:l.task.notes||"",related_goal_id:l.task.related_goal_id||"",is_recurring:!!l.task.is_recurring,recurring_frequency:l.task.recurring_frequency||"",media:[]}),y=x(""),S=x(null),V=x(!1),h=x(""),D=x(["urgent","important","follow-up","review","meeting","documentation"]),M=W(()=>Array.isArray(s.tags)?s.tags.filter(a=>a&&a.trim()):[]),z=()=>{S.value&&S.value.focus()},q=()=>{const a=y.value.trim();h.value=a},I=a=>{const e=y.value.trim();a.key==="Enter"||a.key===","||a.keyCode===188?(a.preventDefault(),e&&U(e)):a.key==="Backspace"&&!e&&M.value.length>0&&(a.preventDefault(),N(M.value.length-1))},$=a=>{a?.preventDefault?.(),a?.stopPropagation?.();const e=y.value.trim();e&&U(e)},U=a=>{if(!a)return;const e=a.trim();e&&(s.tags.includes(e)||s.tags.push(e),y.value="",h.value="")},N=a=>{a>=0&&a<s.tags.length&&s.tags.splice(a,1)},A=a=>{U(a)},K=a=>{console.error("File upload error:",a)},R=()=>{console.log("Form data being submitted:",{status:s.status,priority:s.priority,title:s.title,tags:s.tags});const a=new FormData;Object.keys(s.data()).forEach(e=>{e==="tags"&&Array.isArray(s[e])?a.append(e,JSON.stringify(s[e])):e==="media"&&Array.isArray(s[e])?s[e].forEach(o=>{a.append("media[]",o)}):a.append(e,s[e])}),s.put(route("tasks.web.update",l.task.id),{data:a,preserveScroll:!0,onSuccess:()=>{console.log("Form submitted successfully"),P.visit(route("tasks.web.index"))},onError:e=>{console.error("Form errors:",e)}})},L=()=>{P.visit(route("tasks.web.index"))},H=a=>{const e=a.split(".");return e.length>1?e.pop().toUpperCase().substring(0,3):"FILE"},J=a=>{if(a===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,f)).toFixed(2))+" "+o[f]},X=a=>{confirm("Are you sure you want to remove this file?")&&P.delete(route("tasks.web.media.destroy",{task:l.task.id,media:a}),{preserveScroll:!0,onSuccess:()=>{const e=l.task.media.findIndex(o=>o.id===a);e!==-1&&l.task.media.splice(e,1)},onError:e=>{console.error("Error removing media:",e),alert("Failed to remove the file. Please try again.")}})};return(a,e)=>(n(),Q(ee,null,{header:C(()=>[t("h2",re," Edit Task: "+p(v.task.title),1)]),default:C(()=>[t("div",null,[t("div",ae,[t("div",ie,[t("div",le,[t("form",{onSubmit:F(R,["prevent"]),class:"space-y-6"},[t("div",ne,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Basic Information ",-1)),t("div",null,[i(u,{for:"title",value:"Title *"}),i(T,{id:"title",modelValue:r(s).title,"onUpdate:modelValue":e[0]||(e[0]=o=>r(s).title=o),type:"text",class:g(["mt-1 block w-full",{"border-red-500":r(s).errors.title}]),required:"",autofocus:""},null,8,["modelValue","class"]),i(m,{message:r(s).errors.title,class:"mt-2"},null,8,["message"])]),t("div",de,[i(u,{for:"description",value:"Description *"}),c(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=o=>r(s).description=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.description}]),rows:"4",required:""},null,2),[[E,r(s).description]]),i(m,{message:r(s).errors.description,class:"mt-2"},null,8,["message"])])]),t("div",ue,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Task Details ",-1)),t("div",ge,[t("div",null,[i(u,{for:"priority",value:"Priority *"}),c(t("select",{id:"priority","onUpdate:modelValue":e[2]||(e[2]=o=>r(s).priority=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.priority}]),required:""},e[21]||(e[21]=[t("option",{value:""}," Select Priority ",-1),t("option",{value:"low"},"Low",-1),t("option",{value:"medium"}," Medium ",-1),t("option",{value:"high"},"High",-1),t("option",{value:"urgent"}," Urgent ",-1)]),2),[[b,r(s).priority]]),i(m,{message:r(s).errors.priority,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"status",value:"Status *"}),c(t("select",{id:"status","onUpdate:modelValue":e[3]||(e[3]=o=>r(s).status=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.status}]),required:""},e[22]||(e[22]=[t("option",{value:""}," Select Status ",-1),t("option",{value:"pending"}," Pending ",-1),t("option",{value:"not_started"}," Not Started ",-1),t("option",{value:"in_progress"}," In Progress ",-1),t("option",{value:"completed"}," Completed ",-1),t("option",{value:"cancelled"}," Cancelled ",-1)]),2),[[b,r(s).status]]),i(m,{message:r(s).errors.status,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"due_date",value:"Due Date *"}),i(T,{id:"due_date",modelValue:r(s).due_date,"onUpdate:modelValue":e[4]||(e[4]=o=>r(s).due_date=o),type:"date",class:g(["mt-1 block w-full",{"border-red-500":r(s).errors.due_date}]),required:""},null,8,["modelValue","class"]),i(m,{message:r(s).errors.due_date,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"category",value:"Category"}),c(t("select",{id:"category","onUpdate:modelValue":e[5]||(e[5]=o=>r(s).category=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.category}])},e[23]||(e[23]=[t("option",{value:""}," Select Category ",-1),t("option",{value:"Inventory Management"}," Inventory Management ",-1),t("option",{value:"Client Communication"}," Client Communication ",-1),t("option",{value:"Sales Processing"}," Sales Processing ",-1),t("option",{value:"Content Creation"}," Content Creation ",-1),t("option",{value:"Expense Tracking"}," Expense Tracking ",-1),t("option",{value:"Goal Planning"}," Goal Planning ",-1),t("option",{value:"System Maintenance"}," System Maintenance ",-1),t("option",{value:"Other"},"Other",-1)]),2),[[b,r(s).category]]),i(m,{message:r(s).errors.category,class:"mt-2"},null,8,["message"])])])]),t("div",me,[e[27]||(e[27]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Assignment ",-1)),t("div",ce,[t("div",null,[i(u,{for:"assigned_to",value:"Assigned To"}),c(t("select",{id:"assigned_to","onUpdate:modelValue":e[6]||(e[6]=o=>r(s).assigned_to=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.assigned_to}])},[e[25]||(e[25]=t("option",{value:""},"Unassigned",-1)),(n(!0),d(k,null,_(v.users,o=>(n(),d("option",{key:o.id,value:o.id},p(o.name),9,pe))),128))],2),[[b,r(s).assigned_to]]),i(m,{message:r(s).errors.assigned_to,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"related_goal_id",value:"Related Goal"}),c(t("select",{id:"related_goal_id","onUpdate:modelValue":e[7]||(e[7]=o=>r(s).related_goal_id=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.related_goal_id}])},[e[26]||(e[26]=t("option",{value:""},"No Goal",-1)),(n(!0),d(k,null,_(v.goals,o=>(n(),d("option",{key:o.id,value:o.id},p(o.title),9,fe))),128))],2),[[b,r(s).related_goal_id]]),i(m,{message:r(s).errors.related_goal_id,class:"mt-2"},null,8,["message"])])])]),t("div",ve,[e[28]||(e[28]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Time Tracking ",-1)),t("div",ye,[t("div",null,[i(u,{for:"estimated_hours",value:"Estimated Hours"}),i(T,{id:"estimated_hours",modelValue:r(s).estimated_hours,"onUpdate:modelValue":e[8]||(e[8]=o=>r(s).estimated_hours=o),type:"number",step:"0.5",min:"0",class:g(["mt-1 block w-full",{"border-red-500":r(s).errors.estimated_hours}])},null,8,["modelValue","class"]),i(m,{message:r(s).errors.estimated_hours,class:"mt-2"},null,8,["message"])]),t("div",null,[i(u,{for:"actual_hours",value:"Actual Hours"}),i(T,{id:"actual_hours",modelValue:r(s).actual_hours,"onUpdate:modelValue":e[9]||(e[9]=o=>r(s).actual_hours=o),type:"number",step:"0.5",min:"0",class:g(["mt-1 block w-full",{"border-red-500":r(s).errors.actual_hours}])},null,8,["modelValue","class"]),i(m,{message:r(s).errors.actual_hours,class:"mt-2"},null,8,["message"])])])]),t("div",be,[e[34]||(e[34]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Additional Details ",-1)),t("div",null,[i(u,{for:"tags",value:"Tags"}),t("div",xe,[t("div",ke,[t("div",{class:g(["flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md shadow-sm focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 min-h-12 transition-colors",{"border-red-500":r(s).errors.tags,"bg-gray-50":V.value}]),onClick:z},[(n(!0),d(k,null,_(M.value,(o,f)=>(n(),d("span",{key:f,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 border border-indigo-200 transition-all hover:bg-indigo-200 hover:scale-105"},[j(p(o.trim())+" ",1),t("button",{type:"button",onClick:F(B=>N(f),["stop"]),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors",title:"Remove tag"},e[29]||(e[29]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,_e)]))),128)),c(t("input",{ref_key:"tagInputRef",ref:S,type:"text","onUpdate:modelValue":e[10]||(e[10]=o=>y.value=o),onKeydown:e[11]||(e[11]=(...o)=>I&&I(...o)),onFocus:e[12]||(e[12]=o=>V.value=!0),onBlur:e[13]||(e[13]=o=>V.value=!1),onInput:e[14]||(e[14]=(...o)=>q&&q(...o)),placeholder:"Type to add tags...",class:g(["flex-1 min-w-0 bg-transparent border-none outline-none py-1 px-2 text-sm placeholder-gray-400",{"opacity-50":r(s).processing}]),disabled:r(s).processing},null,42,we),[[E,y.value]]),y.value.trim()?(n(),d("button",{key:0,type:"button",onClick:e[15]||(e[15]=F((...o)=>$&&$(...o),["prevent","stop"])),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors p-1 rounded",title:"Add tag",disabled:r(s).processing},e[30]||(e[30]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,he)):w("",!0)],2),h.value?(n(),d("div",Ce,[t("div",Fe,[e[31]||(e[31]=t("span",null,"Press Enter or Comma to add:",-1)),t("span",Te,p(h.value),1)])])):w("",!0)]),D.value.length>0?(n(),d("div",Se,[e[32]||(e[32]=t("p",{class:"text-xs text-gray-500 mb-1"}," Common tags: ",-1)),t("div",Ve,[(n(!0),d(k,null,_(D.value,(o,f)=>(n(),d("span",{key:f,onClick:B=>A(o),class:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors cursor-pointer inline-block",role:"button",tabindex:"0",onKeydown:[O(B=>A(o),["enter"]),O(F(B=>A(o),["prevent"]),["space"])]},p(o),41,Me))),128))])])):w("",!0),e[33]||(e[33]=t("p",{class:"mt-1 text-xs text-gray-500"}," Press Enter or Comma to add tags. ",-1))]),i(m,{message:r(s).errors.tags,class:"mt-2"},null,8,["message"])]),t("div",Ue,[i(u,{for:"notes",value:"Notes"}),c(t("textarea",{id:"notes","onUpdate:modelValue":e[16]||(e[16]=o=>r(s).notes=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.notes}]),rows:"3"},null,2),[[E,r(s).notes]]),i(m,{message:r(s).errors.notes,class:"mt-2"},null,8,["message"])])]),t("div",Ae,[e[37]||(e[37]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," File Attachments ",-1)),v.task.media&&v.task.media.length>0?(n(),d("div",Be,[i(u,{value:"Existing Files",class:"mb-2"}),t("div",Ee,[(n(!0),d(k,null,_(v.task.media,o=>(n(),d("div",{key:o.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border"},[t("div",Pe,[t("div",De,[t("div",qe,[t("span",Ie,p(H(o.original_name)),1)])]),t("div",$e,[t("p",Ne,p(o.original_name),1),t("p",je,p(J(o.file_size)),1)])]),t("button",{type:"button",onClick:f=>X(o.id),class:"ml-3 text-red-600 hover:text-red-800",title:"Remove file",disabled:r(s).processing},e[35]||(e[35]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Oe)]))),128))])])):w("",!0),t("div",null,[i(u,{value:"Upload New Files",class:"mb-2"}),i(oe,{modelValue:r(s).media,"onUpdate:modelValue":e[17]||(e[17]=o=>r(s).media=o),multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt",maxFiles:10,maxSize:10*1024*1024,title:"Drag & drop files here or click to browse",description:"Supports images, PDFs, and documents (max 10MB each)",onError:K},null,8,["modelValue"]),i(m,{message:r(s).errors.media,class:"mt-2"},null,8,["message"]),e[36]||(e[36]=t("p",{class:"text-xs text-gray-500 mt-2"}," You can upload up to 10 files. Supported formats: JPG, PNG, GIF, PDF, DOC, DOCX, TXT. ",-1))])]),t("div",Ge,[e[39]||(e[39]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Recurring Task ",-1)),t("div",ze,[t("div",Ke,[c(t("input",{id:"is_recurring","onUpdate:modelValue":e[18]||(e[18]=o=>r(s).is_recurring=o),type:"checkbox",class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[Z,r(s).is_recurring]]),i(u,{for:"is_recurring",value:"This is a recurring task",class:"ml-2"})]),r(s).is_recurring?(n(),d("div",Re,[i(u,{for:"recurring_frequency",value:"Frequency"}),c(t("select",{id:"recurring_frequency","onUpdate:modelValue":e[19]||(e[19]=o=>r(s).recurring_frequency=o),class:g(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.recurring_frequency}])},e[38]||(e[38]=[t("option",{value:""}," Select Frequency ",-1),t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"}," Weekly ",-1),t("option",{value:"monthly"}," Monthly ",-1),t("option",{value:"yearly"}," Yearly ",-1)]),2),[[b,r(s).recurring_frequency]]),i(m,{message:r(s).errors.recurring_frequency,class:"mt-2"},null,8,["message"])])):w("",!0)])]),t("div",Le,[i(se,{type:"button",onClick:L,disabled:r(s).processing},{default:C(()=>e[40]||(e[40]=[j(" Cancel ",-1)])),_:1,__:[40]},8,["disabled"]),i(te,{type:"submit",disabled:r(s).processing,class:g({"opacity-50":r(s).processing})},{default:C(()=>[r(s).processing?(n(),d("span",He,"Updating...")):(n(),d("span",Je,"Update Task"))]),_:1},8,["disabled","class"])])],32)])])])])]),_:1}))}};export{st as default};
