import{_ as B,c as k}from"./AuthenticatedLayout-DXmFaX_l.js";import{m as d,x as D,y as M,d as P,o as l,w as $,e as t,c as r,i as p,n as g,t as n,F as I,z as T,g as H}from"./app-BT7s3W82.js";const F={class:"flex items-center justify-between"},R={class:"flex items-center space-x-4"},O={class:"text-sm text-gray-600"},U=["disabled"],J={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-700",fill:"none",viewBox:"0 0 24 24"},Y={class:"bg-white shadow-sm rounded-lg overflow-hidden"},q={class:"border-b border-gray-200 px-6 py-4"},G={class:"flex items-center space-x-4"},K={key:0,class:"p-8 text-center"},Q={key:1,class:"p-8 text-center"},W={class:"mt-2 text-sm text-red-600"},X={key:2,class:"p-8 text-center"},Z={key:3,class:"divide-y divide-gray-200"},ee={class:"flex items-start space-x-4"},te={class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ae=["d"],se={class:"flex-1 min-w-0"},oe={class:"flex items-center justify-between"},le={class:"text-sm font-medium text-gray-900"},re={class:"flex items-center space-x-2"},ne={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ie={class:"text-xs text-gray-500"},de={class:"text-sm text-gray-600 mt-1"},ce={class:"flex flex-col items-center space-y-2"},ue=["onClick","disabled"],ve=["onClick","disabled"],me={key:4,class:"px-6 py-4 border-t border-gray-200"},xe={class:"flex items-center justify-between"},fe={class:"text-sm text-gray-700"},pe={class:"flex space-x-2"},ge=["disabled"],he=["disabled"],ke={__name:"Index",setup(_e){const v=d("all"),c=d([]),u=d(0),h=d(0),w=d(!1),_=d(null),x=d(!1),y=d(new Set),b=d(new Set),o=d(null),f=d(1),m=async()=>{try{w.value=!0,_.value=null;let s=`/api/notifications?page=${f.value}&per_page=20`;v.value!=="all"&&(s+=`&read=${v.value==="read"}`);const a=await fetch(s,{headers:k()});if(!a.ok)throw new Error("Failed to fetch notifications");const e=await a.json();c.value=e.notifications.data||e.notifications,u.value=e.unread_count,h.value=e.notifications.total||e.notifications.length,e.notifications.meta?o.value={current_page:e.notifications.meta.current_page,from:e.notifications.meta.from,to:e.notifications.meta.to,total:e.notifications.meta.total,last_page:e.notifications.meta.last_page,prev_page_url:e.notifications.meta.prev_page_url,next_page_url:e.notifications.meta.next_page_url}:e.notifications.current_page?o.value=e.notifications:o.value=null}catch(s){_.value=s.message,console.error("Error fetching notifications:",s)}finally{w.value=!1}},A=async s=>{try{if(y.value.add(s.id),(await fetch(`/api/notifications/${s.id}`,{method:"PUT",headers:k({"Content-Type":"application/json"}),body:JSON.stringify({read:!0})})).ok){const e=c.value.findIndex(i=>i.id===s.id);e!==-1&&(c.value[e].is_unread=!1,c.value[e].read_at=new Date().toISOString()),u.value=Math.max(0,u.value-1)}}catch(a){console.error("Error marking notification as read:",a)}finally{y.value.delete(s.id)}},S=async()=>{try{x.value=!0,(await fetch("/api/notifications/mark-all-read",{method:"POST",headers:k()})).ok&&(c.value.forEach(a=>{a.is_unread=!1,a.read_at=new Date().toISOString()}),u.value=0)}catch(s){console.error("Error marking all notifications as read:",s)}finally{x.value=!1}},V=async s=>{try{b.value.add(s.id),(await fetch(`/api/notifications/${s.id}`,{method:"DELETE",headers:k()})).ok&&(c.value=c.value.filter(e=>e.id!==s.id),h.value=Math.max(0,h.value-1),s.is_unread&&(u.value=Math.max(0,u.value-1)))}catch(a){console.error("Error deleting notification:",a)}finally{b.value.delete(s.id)}},C=s=>{v.value=s,f.value=1,m()},z=()=>{o.value&&o.value.next_page_url&&(f.value++,m())},L=()=>{o.value&&o.value.prev_page_url&&(f.value--,m())},N=s=>{const a={system_alert:"bg-red-500",task_update:"bg-blue-500",expense_approved:"bg-green-500",goal_achieved:"bg-purple-500",sale_completed:"bg-yellow-500",default:"bg-gray-500"};return a[s]||a.default},E=s=>{const a={system_alert:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z",task_update:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2",expense_approved:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",goal_achieved:"M13 10V3L4 14h7v7l9-11h-7z",sale_completed:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",default:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"};return a[s]||a.default},j=s=>{const a=new Date(s),i=Math.floor((new Date-a)/1e3);return i<60?"Just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<604800?`${Math.floor(i/86400)}d ago`:a.toLocaleDateString()};return D(()=>{m()}),M(v,()=>{m()}),M(f,()=>{m()}),(s,a)=>(l(),P(B,null,{header:$(()=>[t("div",F,[a[4]||(a[4]=t("h2",{class:"text-2xl font-semibold text-gray-900"}," Notifications ",-1)),t("div",R,[t("div",O,n(u.value)+" unread of "+n(h.value)+" total ",1),u.value>0?(l(),r("button",{key:0,onClick:S,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:x.value},[x.value?(l(),r("svg",J,a[3]||(a[3]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):p("",!0),H(" "+n(x.value?"Marking all as read...":"Mark all as read"),1)],8,U)):p("",!0)])])]),default:$(()=>[t("div",Y,[t("div",q,[t("div",G,[a[5]||(a[5]=t("div",{class:"text-sm font-medium text-gray-700"}," Filter by: ",-1)),t("button",{onClick:a[0]||(a[0]=e=>C("all")),class:g(["px-3 py-1 text-sm font-medium rounded-md",v.value==="all"?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900"])}," All ",2),t("button",{onClick:a[1]||(a[1]=e=>C("unread")),class:g(["px-3 py-1 text-sm font-medium rounded-md",v.value==="unread"?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900"])}," Unread ",2),t("button",{onClick:a[2]||(a[2]=e=>C("read")),class:g(["px-3 py-1 text-sm font-medium rounded-md",v.value==="read"?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900"])}," Read ",2)])]),w.value?(l(),r("div",K,a[6]||(a[6]=[t("svg",{class:"animate-spin h-8 w-8 text-blue-600 mx-auto",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",{class:"mt-2 text-sm text-gray-600"}," Loading notifications... ",-1)]))):_.value?(l(),r("div",Q,[a[7]||(a[7]=t("svg",{class:"h-12 w-12 text-red-500 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),t("p",W,n(_.value),1),t("button",{onClick:m,class:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Try again ")])):c.value.length===0?(l(),r("div",X,a[8]||(a[8]=[t("svg",{class:"h-16 w-16 text-gray-300 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1),t("p",{class:"mt-4 text-sm text-gray-600"},"No notifications found",-1),t("p",{class:"text-xs text-gray-500"}," You'll see notifications here when they arrive ",-1)]))):(l(),r("div",Z,[(l(!0),r(I,null,T(c.value,e=>(l(),r("div",{key:e.id,class:g(["px-6 py-4 hover:bg-gray-50 transition-colors",{"bg-blue-50":e.is_unread}])},[t("div",ee,[t("div",{class:g(["flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center",N(e.type)])},[(l(),r("svg",te,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:E(e.type)},null,8,ae)]))],2),t("div",se,[t("div",oe,[t("p",le,n(e.title),1),t("div",re,[e.is_unread?(l(),r("span",ne," Unread ")):p("",!0),t("span",ie,n(j(e.created_at)),1)])]),t("p",de,n(e.message),1)]),t("div",ce,[e.is_unread?(l(),r("button",{key:0,onClick:i=>A(e),class:"text-blue-600 hover:text-blue-800 text-sm",disabled:y.value.has(e.id)},n(y.value.has(e.id)?"...":"Mark read"),9,ue)):p("",!0),t("button",{onClick:i=>V(e),class:"text-gray-400 hover:text-red-600 text-sm",disabled:b.value.has(e.id)},n(b.value.has(e.id)?"...":"Delete"),9,ve)])])],2))),128))])),c.value.length>0&&o.value?(l(),r("div",me,[t("div",xe,[t("div",fe," Showing "+n(o.value.from)+" to "+n(o.value.to)+" of "+n(o.value.total)+" results ",1),t("div",pe,[t("button",{onClick:L,disabled:!o.value.prev_page_url,class:"px-3 py-1 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ge),t("button",{onClick:z,disabled:!o.value.next_page_url,class:"px-3 py-1 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,he)])])])):p("",!0)])]),_:1}))}};export{ke as default};
