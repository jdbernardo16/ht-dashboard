import{B as W,m as p,j as F,x as U,s as X,c as a,o as l,i as d,e as i,g as T,t as n,d as L,n as w,C as P,F as B,y as S,a as $,f as G,u as K}from"./app-DMsrlBw0.js";const Y={class:"space-y-1"},J=["for"],Q={key:0,class:"text-destructive"},ee=["multiple","accept"],te=["src"],se={class:"mb-1 text-xs font-medium text-muted-foreground"},oe={class:"font-semibold text-primary"},le={class:"text-xs text-muted-foreground"},re={key:1},ae={class:"space-y-2"},ie={class:"flex items-center"},ne=["src"],de={key:1,class:"flex items-center justify-center rounded-lg size-10 bg-border"},ce={class:"ml-2 text-xs space-y-1 max-w-[80%] text-ellipsis"},ue={class:"truncate"},pe={class:"text-muted-foreground"},me=["innerHTML"],ve={key:3,class:"text-destructive"},fe={key:4,"test-id":"upload-error",class:"text-xs text-destructive"},ge=W({__name:"BaseFileUploader",props:{id:{},label:{},acceptTypes:{default:()=>["image"]},description:{default:"Files (WebP) up to 2MB"},maxSize:{default:50},multiple:{type:Boolean,default:!1},helper:{},error:{},disabled:{type:Boolean},required:{type:Boolean},labelClass:{},withPreview:{type:Boolean,default:!0},iconOnly:{type:Boolean,default:!1},iconClass:{default:"size-8 mb-2"},iconImgClass:{default:""},modelValue:{}},emits:["update:modelValue"],setup(I,{emit:O}){let m;try{m=require("@vueuse/core").useDropZone}catch{console.warn("@vueuse/core not available, using fallback drag and drop")}let v,f,h,g,y,k;try{const e=require("lucide-vue-next");v=e.Paperclip,f=e.Image,h=e.Video,g=e.FileText,y=e.X,k=e.ImagePlus}catch{console.warn("lucide-vue-next not available, using fallback icons"),v={template:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"></path></svg>'},f={template:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'},h={template:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>'},g={template:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'},y={template:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>'},k={template:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>'}}const r=I,b=O,_=p(),M=p(null),s=p([]),c=p([]),Z=F(()=>{const e={image:"image/jpeg,image/png,image/jpg,image/gif,image/svg+xml,image/webp",video:"video/mp4,video/quicktime,video/x-msvideo,video/x-ms-wmv",pdf:"application/pdf",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",csv:"text/csv"};return r.acceptTypes.map(t=>e[t]).join(",")}),C=F(()=>r.iconOnly?k:r.acceptTypes.includes("image")?f:r.acceptTypes.includes("video")?h:r.acceptTypes.includes("pdf")?g:v),V=e=>{if(!e)return;c.value=[];const t=[];e.forEach(o=>{A(o)?H(o)?t.push({file:o}):c.value.push({file:o.name,error:`File size exceeds ${r.maxSize}MB limit`}):c.value.push({file:o.name,error:"File type not accepted"})}),!r.multiple&&t.length>1?(c.value.push({file:"Multiple files",error:"Only single file upload is allowed"}),s.value=t.slice(0,1)):s.value=t,E()};p(!1),m&&m(_,V).isOverDropZone;const A=e=>r.acceptTypes.some(t=>t==="pdf"?e.type==="application/pdf":t==="xlsx"?e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||e.type==="application/vnd.ms-excel":t==="csv"?e.type==="text/csv":t==="video"?["video/mp4","video/quicktime","video/x-msvideo","video/x-ms-wmv"].includes(e.type):t==="image"?["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml","image/webp"].includes(e.type):e.type.startsWith(t)),H=e=>e.size<=r.maxSize*1024*1024,q=e=>{const t=e.target.files;t&&V(Array.from(t))},R=()=>{M.value?.click()},E=async()=>{s.value.forEach(e=>{if(e.file.type.startsWith("image/")){const t=new FileReader;t.onload=o=>{e.preview=o.target?.result,x()},t.readAsDataURL(e.file)}else x()})},D=e=>{s.value.splice(e,1),x()},N=(e,t=2)=>{if(e===0)return"0 Bytes";const o=1024,u=t<0?0:t,z=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],j=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,j)).toFixed(u))+" "+z[j]},x=()=>{r.multiple?b("update:modelValue",s.value.length>0?s.value:null):b("update:modelValue",s.value.length>0?s.value[0]:null)};return U(()=>r.modelValue,e=>{e?Array.isArray(e)?s.value=e:s.value=[e]:s.value=[]}),X(()=>{r.modelValue&&(Array.isArray(r.modelValue)?s.value=r.modelValue:s.value=[r.modelValue])}),(e,t)=>(l(),a("div",Y,[e.label?(l(),a("label",{key:0,for:e.id,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},[T(n(e.label)+" ",1),e.required?(l(),a("span",Q,"*")):d("",!0)],8,J)):d("",!0),i("div",{ref_key:"dropZoneRef",ref:_,onClick:R,class:w(["flex flex-col items-center justify-center text-center transition border-2 border-dashed rounded-lg cursor-pointer hover:border-muted-foreground",[e.error?"border-destructive":"",e.disabled?"pointer-events-none opacity-50":"",e.iconOnly?s.value?.length&&s.value[0].preview?"px-2 py-1.5":"px-3 py-2.5":"px-4 py-3 min-h-[150px]"]])},[i("input",{ref_key:"fileInput",ref:M,type:"file",class:"hidden",onChange:q,multiple:e.multiple,accept:Z.value},null,40,ee),e.iconOnly&&s.value?.length&&s.value[0]?.preview?(l(),a("img",{key:0,src:s.value[0].preview,alt:"preview",class:w(["object-cover rounded-md size-10 shrink-0",e.iconImgClass])},null,10,te)):(l(),L(P(C.value),{key:1,class:w(e.iconClass)},null,8,["class"])),e.iconOnly?d("",!0):(l(),a(B,{key:2},[i("p",se,[i("span",oe,n(r.multiple?"Select multiple files":"Select a file"),1),t[0]||(t[0]=T(" or drag and drop ",-1))]),i("p",le,n(e.description),1)],64))],2),s.value&&e.withPreview&&!e.iconOnly?(l(),a("div",re,[i("div",ae,[(l(!0),a(B,null,S(s.value,(o,u)=>(l(),a("div",{key:u,class:"relative flex items-center justify-between p-3 space-x-2 border rounded-lg"},[i("div",ie,[o.preview?(l(),a("img",{key:0,src:o.preview,alt:"preview",class:"object-cover rounded-md size-10 shrink"},null,8,ne)):(l(),a("div",de,[(l(),L(P(C.value),{class:"size-8 text-muted-foreground"}))])),i("div",ce,[i("p",ue,n(o?.file?.name),1),i("p",pe,n(N(o?.file?.size)),1)])]),$(K(y),{onClick:G(z=>D(u),["stop"]),class:"ml-auto cursor-pointer size-5 text-destructive shrink-0"},null,8,["onClick"])]))),128))])])):d("",!0),e.helper?(l(),a("p",{key:2,class:"text-xs text-muted-foreground",innerHTML:e.helper},null,8,me)):d("",!0),c.value.length>0?(l(),a("div",ve,[(l(!0),a(B,null,S(c.value,(o,u)=>(l(),a("p",{key:u,class:"text-xs","test-id":"fileType-error"},n(o.file)+": "+n(o.error),1))),128))])):d("",!0),e.error?(l(),a("p",fe,n(e.error),1)):d("",!0)]))}});export{ge as _};
