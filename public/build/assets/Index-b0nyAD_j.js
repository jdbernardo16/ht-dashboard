import{m as _,j as A,y as E,x as S,d as j,o as a,w as i,e as l,a as p,t as n,c,i as V,s as d}from"./app-DIXSCgPE.js";import{_ as B}from"./AuthenticatedLayout-_5prmJNd.js";import{D,_ as N}from"./Pagination-BH6EuZQ9.js";import{_ as O}from"./SearchFilter-DSYnmZHA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-D2ye1GDc.js";const T={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},P={class:"flex items-center"},F={class:"flex-shrink-0 h-10 w-10"},H={key:0,class:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden"},I=["src","alt"],M={key:1,class:"h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center"},R={class:"text-white font-medium text-sm"},U={class:"ml-4"},W={class:"font-medium text-gray-900"},Y={key:0,class:"text-sm text-gray-500"},q=["href"],z={key:1,class:"text-gray-400"},G={key:0},J={key:1,class:"text-gray-400"},K={class:"font-medium text-blue-600"},L={class:"font-medium text-green-600"},le={__name:"Index",props:{clients:{type:Object,required:!0},filters:{type:Object,default:()=>({})}},setup(f){const o=f,u=_(!1),r=_({search:o.filters.search||"",category:o.filters.category||"",company:o.filters.company||""}),h=[{value:"Consignment Partner",label:"Consignment Partner"},{value:"Direct Buyer",label:"Direct Buyer"},{value:"Wholesale Client",label:"Wholesale Client"},{value:"Retail Customer",label:"Retail Customer"},{value:"Corporate Account",label:"Corporate Account"},{value:"Auction House",label:"Auction House"},{value:"Other",label:"Other"}],y=A(()=>o.clients.data||[]),v=[{key:"name",label:"Client",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"company",label:"Company",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"sales_count",label:"Sales",type:"number",sortable:!0},{key:"content_posts_count",label:"Content Posts",type:"number",sortable:!0}],g=()=>{d.visit("/clients/create")},b=s=>{d.visit(`/clients/${s.id}/edit`)},x=s=>{d.visit(`/clients/${s.id}`)},C=async s=>{if(confirm("Are you sure you want to delete this client? This action cannot be undone."))try{u.value=!0,await d.delete(`/clients/${s.id}`,{preserveScroll:!0,onSuccess:()=>{},onError:t=>{console.error("Error deleting client:",t),t.message?.includes("403")&&alert("You don't have permission to delete this client.")},onFinish:()=>{u.value=!1}})}catch(t){u.value=!1,console.error("Error deleting client:",t)}},m=()=>{u.value=!0;const s={};Object.keys(r.value).forEach(t=>{r.value[t]&&(s[t]=r.value[t])}),d.get("/clients",s,{preserveState:!0,preserveScroll:!0,only:["clients","filters"],onError:t=>{console.error("Error applying filters:",t),t.message?.includes("403")&&alert("You don't have permission to view clients.")},onFinish:()=>{u.value=!1}})},k=()=>{r.value={search:"",category:"",company:""},m()},w=s=>{d.visit(s,{preserveState:!0,preserveScroll:!0,only:["clients","filters"]})},$=(s,t)=>`${s?.charAt(0)||""}${t?.charAt(0)||""}`.toUpperCase();return E(r,()=>{clearTimeout(window.filterTimeout),window.filterTimeout=setTimeout(()=>{m()},300)},{deep:!0}),S(()=>{}),(s,t)=>(a(),j(B,null,{header:i(()=>t[1]||(t[1]=[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Client Management ",-1)])),default:i(()=>[l("div",null,[l("div",T,[p(O,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),filters:["search","category","company"],"category-options":h,onApply:m,onClear:k},null,8,["modelValue"]),p(D,{data:y.value,columns:v,filters:[],loading:u.value,onCreate:g,onView:x,onEdit:b,onDelete:C},{name:i(({item:e})=>[l("div",P,[l("div",F,[e.profile_image_url?(a(),c("div",H,[l("img",{src:e.profile_image_url,alt:`${e.first_name} ${e.last_name}`,class:"h-full w-full object-cover"},null,8,I)])):(a(),c("div",M,[l("span",R,n($(e.first_name,e.last_name)),1)]))]),l("div",U,[l("div",W,n(e.first_name)+" "+n(e.last_name),1),e.company?(a(),c("div",Y,n(e.company),1)):V("",!0)])])]),email:i(({item:e})=>[e.email?(a(),c("a",{key:0,href:`mailto:${e.email}`,class:"text-indigo-600 hover:text-indigo-900"},n(e.email),9,q)):(a(),c("span",z,"N/A"))]),phone:i(({item:e})=>[e.phone?(a(),c("span",G,n(e.phone),1)):(a(),c("span",J,"N/A"))]),sales_count:i(({item:e})=>[l("span",K,n(e.sales_count||0),1)]),content_posts_count:i(({item:e})=>[l("span",L,n(e.content_posts_count||0),1)]),_:1},8,["data","loading"]),p(N,{links:o.clients.links,from:o.clients.from,to:o.clients.to,total:o.clients.total,onNavigate:w},null,8,["links","from","to","total"])])])]),_:1}))}};export{le as default};
