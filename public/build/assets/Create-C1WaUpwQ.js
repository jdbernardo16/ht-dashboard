import{m as _,b as Y,x as J,j as O,d as W,o as c,w as M,e as s,f as w,a as r,k as p,n as d,u as a,c as g,F as h,y as k,t as v,z as U,v as H,p as V,i as P,g as Q,A as N,q as X}from"./app-DMsrlBw0.js";import{_ as Z}from"./AuthenticatedLayout-CoyhxnNm.js";import{_ as i,b as u,a as y}from"./TextInput-FbyQ28m3.js";import{_ as B}from"./BaseFileUploader.vue_vue_type_script_setup_true_lang-BrDptZMF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},oe={class:"p-6 text-gray-900"},le=["value"],se={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},ae=["id","value"],re=["for"],ne={class:"mt-4"},ie={class:"mt-1"},de={class:"relative"},ue=["onClick"],me=["disabled"],ce=["disabled"],ge={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 p-2"},pe={class:"text-sm text-gray-600 flex items-center justify-between"},fe={class:"font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded"},be={key:0,class:"mt-1 p-2 bg-gray-50 border border-gray-200 rounded-md"},ve={class:"flex flex-wrap gap-1"},ye=["onClick","onKeydown"],_e={class:"text-xs text-gray-500 mt-1"},xe={class:"flex items-center justify-end space-x-3"},we=["disabled"],De={__name:"Create",props:{clients:{type:Array,required:!0}},setup(E){const f=_(!1),q=[{value:"website",label:"Website"},{value:"facebook",label:"Facebook"},{value:"instagram",label:"Instagram"},{value:"twitter",label:"Twitter"},{value:"linkedin",label:"LinkedIn"},{value:"tiktok",label:"TikTok"},{value:"youtube",label:"YouTube"},{value:"pinterest",label:"Pinterest"},{value:"email",label:"Email"},{value:"other",label:"Other"}],l=Y({client_id:"",title:"",platform:[],content_type:"",description:"",content_url:"",image:null,post_count:1,scheduled_date:"",published_date:"",status:"draft",content_category:"",tags:[],notes:"",meta_description:"",seo_keywords:"",media:[]});J(()=>l.image,o=>{o&&typeof o=="object"&&o.file instanceof File&&console.log("FileData object received with file:",o.file.name,"and preview:",o.preview?"available":"not available")},{deep:!0});const b=_(""),F=_(null),C=_(!1),x=_(""),A=_(["social-media","blog","video","image","campaign","promotional","educational","entertainment"]),D=O(()=>Array.isArray(l.tags)?l.tags.filter(o=>o&&o.trim()):[]),G=()=>{F.value&&F.value.focus()},K=()=>{const o=b.value.trim();x.value=o},L=o=>{const e=b.value.trim();o.key==="Enter"||o.key===","||o.keyCode===188?(o.preventDefault(),e&&S(e)):o.key==="Backspace"&&!e&&D.value.length>0&&(o.preventDefault(),j(D.value.length-1))},I=o=>{o?.preventDefault?.(),o?.stopPropagation?.();const e=b.value.trim();e&&S(e)},S=o=>{if(!o)return;const e=o.trim();e&&(l.tags.includes(e)||l.tags.push(e),b.value="",x.value="")},j=o=>{o>=0&&o<l.tags.length&&l.tags.splice(o,1)},T=o=>{S(o)},R=()=>{f.value=!0;const o={...l.data()};if(console.log("Original form data:",o),o.client_id===""||o.client_id===null?(o.client_id=null,console.log("Client ID set to null")):(o.client_id=parseInt(o.client_id),console.log("Client ID converted to number:",o.client_id)),o.published_date){const t=new Date(o.published_date);if(!isNaN(t.getTime())){const n=t.getFullYear(),m=String(t.getMonth()+1).padStart(2,"0"),$=String(t.getDate()).padStart(2,"0");o.published_date=`${n}-${m}-${$}`,console.log("Published date formatted:",o.published_date)}}if(o.scheduled_date){const t=new Date(o.scheduled_date);if(!isNaN(t.getTime())){const n=t.getFullYear(),m=String(t.getMonth()+1).padStart(2,"0"),$=String(t.getDate()).padStart(2,"0");o.scheduled_date=`${n}-${m}-${$}`,console.log("Scheduled date formatted:",o.scheduled_date)}}o.content_url===""&&(o.content_url=null,console.log("Content URL set to null"));const e=new FormData;Object.keys(o).forEach(t=>{t==="media"?Array.isArray(o.media)&&o.media.forEach((n,m)=>{n?.file instanceof File?e.append(`media[${m}]`,n.file):n instanceof File&&e.append(`media[${m}]`,n)}):t==="image"?(console.log("Processing image field:",o.image),o.image&&typeof o.image=="object"&&o.image.file instanceof File?(e.append(t,o.image.file),console.log("Appended image file from FileData object:",o.image.file.name)):o.image instanceof File?(e.append(t,o.image),console.log("Appended direct File object:",o.image.name)):o.image&&typeof o.image=="object"&&o.image instanceof File?(e.append(t,o.image),console.log("Appended File object (wrapped case):",o.image.name)):o.image===null||o.image===void 0||o.image===""?console.log("Image field is empty, skipping"):console.error("Image field is not a valid File object or FileData:",o.image,"Type:",typeof o.image)):Array.isArray(o[t])?t==="platform"||t==="tags"?e.append(t,JSON.stringify(o[t])):o[t].forEach((n,m)=>{e.append(`${t}[${m}]`,n)}):o[t]===null?e.append(t,""):e.append(t,o[t])}),console.log("FormData client_id:",e.get("client_id")),console.log("FormData published_date:",e.get("published_date")),console.log("FormData scheduled_date:",e.get("scheduled_date")),console.log("FormData content_url:",e.get("content_url")),console.log("FormData image field:",e.get("image")),console.log("Form image field value:",o.image),console.log("Form image field type:",typeof o.image),console.log("Final form data being submitted:");for(let t of e.entries())console.log(t[0]+":",t[1]);l.post(route("content.web.store"),{data:e,onSuccess:()=>{},onError:t=>{console.error("Form submission error:",t)},onFinish:()=>{f.value=!1}})},z=()=>{X.visit(route("content.web.index"))};return(o,e)=>(c(),W(Z,null,{header:M(()=>e[20]||(e[20]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Create New Content Post ",-1)])),default:M(()=>[s("div",null,[s("div",ee,[s("div",te,[s("div",oe,[s("form",{onSubmit:w(R,["prevent"]),class:"space-y-6"},[s("div",null,[r(i,{for:"client_id",value:"Client *"}),p(s("select",{id:"client_id","onUpdate:modelValue":e[0]||(e[0]=t=>a(l).client_id=t),required:"",class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.client_id}])},[e[21]||(e[21]=s("option",{value:""},"Select a client",-1)),(c(!0),g(h,null,k(E.clients,t=>(c(),g("option",{key:t.id,value:t.id},v(t.name),9,le))),128))],2),[[U,a(l).client_id]]),r(u,{message:a(l).errors.client_id,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"title",value:"Title *"}),r(y,{id:"title",modelValue:a(l).title,"onUpdate:modelValue":e[1]||(e[1]=t=>a(l).title=t),type:"text",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.title}]),required:""},null,8,["modelValue","class"]),r(u,{message:a(l).errors.title,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{value:"Platforms *",class:"mb-2"}),s("div",se,[(c(),g(h,null,k(q,t=>s("div",{key:t.value,class:"flex items-center"},[p(s("input",{type:"checkbox",id:`platform-${t.value}`,value:t.value,"onUpdate:modelValue":e[2]||(e[2]=n=>a(l).platform=n),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,8,ae),[[H,a(l).platform]]),s("label",{for:`platform-${t.value}`,class:"ml-2 text-sm text-gray-700"},v(t.label),9,re)])),64))]),r(u,{message:a(l).errors.platform,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"content_type",value:"Content Type *"}),p(s("select",{id:"content_type","onUpdate:modelValue":e[3]||(e[3]=t=>a(l).content_type=t),required:"",class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.content_type}])},e[22]||(e[22]=[s("option",{value:""}," Select content type ",-1),s("option",{value:"post"},"Post",-1),s("option",{value:"story"},"Story",-1),s("option",{value:"reel"},"Reel",-1),s("option",{value:"video"},"Video",-1),s("option",{value:"image"},"Image",-1),s("option",{value:"carousel"},"Carousel",-1),s("option",{value:"live"},"Live",-1),s("option",{value:"article"},"Article",-1)]),2),[[U,a(l).content_type]]),r(u,{message:a(l).errors.content_type,class:"mt-2"},null,8,["message"])]),s("div",ne,[r(i,{for:"description",value:"Description"}),p(s("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=t=>a(l).description=t),class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.description}]),rows:"4"},null,2),[[V,a(l).description]]),r(u,{message:a(l).errors.description,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"content_url",value:"Content URL"}),r(y,{id:"content_url",modelValue:a(l).content_url,"onUpdate:modelValue":e[5]||(e[5]=t=>a(l).content_url=t),type:"url",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.content_url}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.content_url,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"post_count",value:"Post Count"}),r(y,{id:"post_count",modelValue:a(l).post_count,"onUpdate:modelValue":e[6]||(e[6]=t=>a(l).post_count=t),type:"number",min:"1",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.post_count}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.post_count,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"scheduled_date",value:"Scheduled Date"}),r(y,{id:"scheduled_date",modelValue:a(l).scheduled_date,"onUpdate:modelValue":e[7]||(e[7]=t=>a(l).scheduled_date=t),type:"date",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.scheduled_date}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.scheduled_date,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"published_date",value:"Published Date"}),r(y,{id:"published_date",modelValue:a(l).published_date,"onUpdate:modelValue":e[8]||(e[8]=t=>a(l).published_date=t),type:"date",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.published_date}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.published_date,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"status",value:"Status *"}),p(s("select",{id:"status","onUpdate:modelValue":e[9]||(e[9]=t=>a(l).status=t),required:"",class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.status}])},e[23]||(e[23]=[s("option",{value:"draft"},"Draft",-1),s("option",{value:"scheduled"},"Scheduled",-1),s("option",{value:"published"},"Published",-1),s("option",{value:"archived"},"Archived",-1)]),2),[[U,a(l).status]]),r(u,{message:a(l).errors.status,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"content_category",value:"Content Category"}),r(y,{id:"content_category",modelValue:a(l).content_category,"onUpdate:modelValue":e[10]||(e[10]=t=>a(l).content_category=t),type:"text",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.content_category}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.content_category,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"tags",value:"Tags"}),s("div",ie,[s("div",de,[s("div",{class:d(["flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md shadow-sm focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 min-h-12 transition-colors",{"border-red-500":a(l).errors.tags,"bg-gray-50":C.value}]),onClick:G},[(c(!0),g(h,null,k(D.value,(t,n)=>(c(),g("span",{key:n,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 border border-indigo-200 transition-all hover:bg-indigo-200 hover:scale-105"},[Q(v(t.trim())+" ",1),s("button",{type:"button",onClick:w(m=>j(n),["stop"]),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors",title:"Remove tag"},e[24]||(e[24]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ue)]))),128)),p(s("input",{ref_key:"tagInputRef",ref:F,type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>b.value=t),onKeydown:L,onFocus:e[12]||(e[12]=t=>C.value=!0),onBlur:e[13]||(e[13]=t=>C.value=!1),onInput:K,placeholder:"Type to add tags...",class:d(["flex-1 min-w-0 bg-transparent border-none outline-none py-1 px-2 text-sm placeholder-gray-400",{"opacity-50":f.value}]),disabled:f.value},null,42,me),[[V,b.value]]),b.value.trim()?(c(),g("button",{key:0,type:"button",onClick:e[14]||(e[14]=w((...t)=>I&&I(...t),["prevent","stop"])),class:"text-indigo-600 hover:text-indigo-800 focus:outline-none transition-colors p-1 rounded",title:"Add tag",disabled:f.value},e[25]||(e[25]=[s("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,ce)):P("",!0)],2),x.value?(c(),g("div",ge,[s("div",pe,[e[26]||(e[26]=s("span",null,"Press Enter or Comma to add:",-1)),s("span",fe,v(x.value),1)])])):P("",!0)]),A.value.length>0?(c(),g("div",be,[e[27]||(e[27]=s("p",{class:"text-xs text-gray-500 mb-1"}," Common tags: ",-1)),s("div",ve,[(c(!0),g(h,null,k(A.value,(t,n)=>(c(),g("span",{key:n,onClick:m=>T(t),class:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors cursor-pointer inline-block",role:"button",tabindex:"0",onKeydown:[N(m=>T(t),["enter"]),N(w(m=>T(t),["prevent"]),["space"])]},v(t),41,ye))),128))])])):P("",!0)]),r(u,{message:a(l).errors.tags,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"notes",value:"Notes"}),p(s("textarea",{id:"notes","onUpdate:modelValue":e[15]||(e[15]=t=>a(l).notes=t),rows:"3",class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.notes}])},null,2),[[V,a(l).notes]]),r(u,{message:a(l).errors.notes,class:"mt-2"},null,8,["message"])]),s("div",null,[r(i,{for:"meta_description",value:"Meta Description"}),p(s("textarea",{id:"meta_description","onUpdate:modelValue":e[16]||(e[16]=t=>a(l).meta_description=t),rows:"2",maxlength:"255",class:d(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":a(l).errors.meta_description}])},null,2),[[V,a(l).meta_description]]),r(u,{message:a(l).errors.meta_description,class:"mt-2"},null,8,["message"]),s("p",_e,v(a(l).meta_description?a(l).meta_description.length:0)+"/255 characters ",1)]),s("div",null,[r(i,{for:"seo_keywords",value:"SEO Keywords"}),r(y,{id:"seo_keywords",modelValue:a(l).seo_keywords,"onUpdate:modelValue":e[17]||(e[17]=t=>a(l).seo_keywords=t),type:"text",maxlength:"255",class:d(["mt-1 block w-full",{"border-red-500":a(l).errors.seo_keywords}])},null,8,["modelValue","class"]),r(u,{message:a(l).errors.seo_keywords,class:"mt-2"},null,8,["message"]),e[28]||(e[28]=s("p",{class:"text-xs text-gray-500 mt-1"}," Separate keywords with commas ",-1))]),s("div",null,[r(i,{value:"Upload Image",class:"mb-2"}),r(B,{modelValue:a(l).image,"onUpdate:modelValue":e[18]||(e[18]=t=>a(l).image=t),label:"Main Image","accept-types":["image"],multiple:!1,"max-size":10,description:"Drag & drop image here or click to browse","with-preview":!0,required:!1,error:a(l).errors.image},null,8,["modelValue","error"]),e[29]||(e[29]=s("p",{class:"text-xs text-gray-500 mt-2"}," Upload a single image file. Supported formats: JPG, PNG, GIF, WebP (max 10MB) ",-1))]),s("div",null,[r(i,{value:"Upload Additional Files",class:"mb-2"}),r(B,{modelValue:a(l).media,"onUpdate:modelValue":e[19]||(e[19]=t=>a(l).media=t),label:"Additional Files","accept-types":["image","pdf","xlsx","csv"],multiple:!0,"max-size":10,description:"Drag & drop files here or click to browse","with-preview":!1,required:!1,error:a(l).errors.media},null,8,["modelValue","error"]),e[30]||(e[30]=s("p",{class:"text-xs text-gray-500 mt-2"}," You can upload up to 10 files. Supported formats: JPG, PNG, GIF, PDF, Excel, CSV (max 10MB each) ",-1))]),s("div",xe,[s("button",{type:"button",onClick:z,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Cancel "),s("button",{type:"submit",disabled:f.value,class:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"},v(f.value?"Creating...":"Create Content Post"),9,we)])],32)])])])])]),_:1}))}};export{De as default};
